import{u as A,r,e as y,j as e,m as T}from"./vendor-Cr6tcs86.js";import{B as j,I as m}from"./index-Db5g7dLZ.js";import{w as P,p as R,j as B,ak as z,a0 as D,c as E,h as $}from"./ui-BBn2VFCU.js";const I=()=>{const d=A(),[k,x]=r.useState(!1),[F,u]=r.useState(!1),[v,N]=r.useState(!1),[h,i]=r.useState(null),[l,b]=r.useState(""),[p,o]=r.useState([]),[s,g]=r.useState(null),[a,f]=r.useState({amount:"",payment_method:"CASH",reference_number:"",description:"Tuition Fee Payment",term:1});r.useEffect(()=>{const t=setTimeout(()=>{l.length>=2?w():o([])},300);return()=>clearTimeout(t)},[l]);const w=async()=>{u(!0);try{const t=await y.get(`/api/students/?search=${l}`);t.data.students&&o(t.data.students)}catch(t){console.error(t)}finally{u(!1)}},S=t=>{g(t),b(""),o([])},n=t=>{f({...a,[t.target.name]:t.target.value})},C=async t=>{if(t.preventDefault(),!s){i("Please select a student first");return}x(!0),i(null);try{const c={student_id:s.id,...a};(await y.post("/api/finance/payment/",c)).data.success&&(N(!0),setTimeout(()=>{d("/finance")},2e3))}catch(c){i(c.response?.data?.error||"Failed to record payment")}finally{x(!1)}},_=[{id:"CASH",label:"Cash",icon:z,color:"text-green-600",bg:"bg-green-50",border:"border-green-100"},{id:"MPESA",label:"M-Pesa",icon:D,color:"text-emerald-600",bg:"bg-emerald-50",border:"border-emerald-100"},{id:"BANK",label:"Bank Transfer",icon:E,color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-100"}];return v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-950 p-6",children:e.jsxs(T.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white dark:bg-slate-900 p-8 rounded-2xl shadow-xl text-center max-w-md w-full border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(P,{size:40,className:"text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:"Payment Recorded!"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:"The payment has been successfully recorded to the student's account."}),e.jsx(j,{onClick:()=>d("/finance"),className:"w-full",children:"Back to Finance"})]})}):e.jsxs("div",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("button",{onClick:()=>d("/finance"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(R,{size:24,className:"text-slate-600 dark:text-slate-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Record Payment"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Add a new payment transaction"})]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800 overflow-hidden",children:e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Select Student"}),s?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-primary-50 dark:bg-primary-900/10 rounded-xl border border-primary-100 dark:border-primary-800",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-white dark:bg-slate-800 text-primary-600 dark:text-primary-400 flex items-center justify-center font-bold shadow-sm",children:s.full_name?.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-primary-900 dark:text-primary-100",children:s.full_name}),e.jsxs("p",{className:"text-sm text-primary-700 dark:text-primary-300",children:["ADM: ",s.admission_number]})]})]}),e.jsx("button",{onClick:()=>g(null),className:"text-primary-600 hover:text-primary-800 text-sm font-medium",children:"Change"})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx(B,{size:20})}),e.jsx("input",{type:"text",placeholder:"Search by name or admission number...",className:"w-full h-12 pl-12 pr-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-primary-100 focus:border-primary-500 transition-all outline-none",value:l,onChange:t=>b(t.target.value)}),p.length>0&&e.jsx("div",{className:"absolute top-14 left-0 right-0 bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-100 dark:border-slate-700 z-10 max-h-60 overflow-y-auto",children:p.map(t=>e.jsxs("button",{onClick:()=>S(t),className:"w-full p-4 flex items-center gap-4 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors text-left border-b border-slate-50 dark:border-slate-700 last:border-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 flex items-center justify-center font-bold text-sm",children:t.full_name?.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:t.full_name}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["ADM: ",t.admission_number," â€¢ ",t.grade]})]})]},t.id))})]})]}),e.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${s?"opacity-100":"opacity-50 pointer-events-none filter blur-[1px]"}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:"Amount (KES)",name:"amount",type:"number",value:a.amount,onChange:n,placeholder:"0.00",required:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 ml-1",children:"Term"}),e.jsxs("select",{name:"term",value:a.term,onChange:n,className:"w-full h-11 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white px-4 focus:ring-2 focus:ring-primary-100 focus:border-primary-500 transition-all outline-none",children:[e.jsx("option",{value:1,children:"Term 1"}),e.jsx("option",{value:2,children:"Term 2"}),e.jsx("option",{value:3,children:"Term 3"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 ml-1",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:_.map(t=>e.jsxs("button",{type:"button",onClick:()=>f({...a,payment_method:t.id}),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition-all ${a.payment_method===t.id?`${t.bg} dark:bg-opacity-10 ${t.border} dark:border-opacity-30 ring-2 ring-primary-500 ring-offset-2 dark:ring-offset-slate-900`:"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 hover:border-primary-200 dark:hover:border-primary-700"}`,children:[e.jsx(t.icon,{className:a.payment_method===t.id?t.color:"text-slate-400 dark:text-slate-500",size:24}),e.jsx("span",{className:`text-sm font-medium ${a.payment_method===t.id?"text-slate-900 dark:text-white":"text-slate-500 dark:text-slate-400"}`,children:t.label})]},t.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(m,{label:"Reference Number",name:"reference_number",value:a.reference_number,onChange:n,placeholder:a.payment_method==="CASH"?"Optional for Cash":"Required",required:a.payment_method!=="CASH"}),e.jsx(m,{label:"Description",name:"description",value:a.description,onChange:n,placeholder:"e.g. Tuition Fee"})]}),h&&e.jsxs("div",{className:"p-4 bg-red-50 text-red-600 rounded-xl flex items-center gap-2 text-sm",children:[e.jsx($,{size:18}),h]}),e.jsx("div",{className:"pt-4",children:e.jsx(j,{onClick:C,isLoading:k,className:"w-full h-12 text-lg",disabled:!s,children:"Record Payment"})})]})]})})]})};export{I as default};
