import{u as N,r as l,d as y,j as e,e as x}from"./vendor-Cr6tcs86.js";import{u as v,I as h,B as C}from"./index-DR2ymqTX.js";import{G as I,h as _,m as E,g as L,A as D}from"./ui-BBn2VFCU.js";const R=()=>{const p=N(),{config:n}=v(),[a,f]=l.useState({username:"",password:""}),[i,o]=l.useState(""),[b,u]=l.useState(!1),[j,d]=l.useState(null),[w,m]=l.useState(!0),c=new URLSearchParams(window.location.search),t=c.get("slug")||localStorage.getItem("portal_slug");c.get("slug")&&localStorage.setItem("portal_slug",c.get("slug")),y.useEffect(()=>{(async()=>{if(t)try{const s=await x.get("/api/config/",{headers:{"X-Portal-Slug":t}});d(s.data)}catch(s){console.error("Failed to fetch school config:",s),d(n)}finally{m(!1)}else d(n),m(!1)})()},[t,n]);const g=r=>{f({...a,[r.target.name]:r.target.value}),o("")},S=async r=>{r.preventDefault(),o(""),u(!0);try{const s=await x.post("/api/login/",{username:a.username,password:a.password,portal_slug:t});s.data.success&&(localStorage.setItem("user",JSON.stringify(s.data.user)),s.data.portal_slug&&localStorage.setItem("portal_slug",s.data.portal_slug),s.data.user.role==="student"&&s.data.user.student_id?p(`/student/${s.data.user.student_id}`):o("This portal is for students only"))}catch(s){o(s.response?.data?.error||"Invalid credentials")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4 font-sans text-slate-900 selection:bg-green-100 selection:text-green-900",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-3xl p-8 lg:p-10 shadow-xl shadow-slate-200/50 border border-slate-100",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-50 text-green-600 rounded-2xl mb-6",children:e.jsx(I,{size:32})}),w?e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-6 bg-slate-100 rounded w-3/4 mx-auto"}),e.jsx("div",{className:"h-4 bg-slate-50 rounded w-1/2 mx-auto"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:j?.school_name||"Student Portal"}),e.jsx("p",{className:"text-slate-500",children:"Sign in to check your grades & schedule"}),t&&e.jsx("div",{className:"mt-4",children:e.jsx("span",{className:"text-xs font-bold text-slate-400 bg-slate-50 border border-slate-100 px-3 py-1 rounded-full uppercase tracking-wider",children:t})})]})]}),i&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-100 rounded-xl flex items-start gap-3",children:[e.jsx(_,{size:20,className:"text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm font-medium text-red-700",children:i})]}),e.jsxs("form",{onSubmit:S,className:"space-y-5",children:[e.jsx(h,{label:"Student ID",type:"text",name:"username",value:a.username,onChange:g,placeholder:"Enter your student ID",required:!0,autoFocus:!0,icon:E,className:"bg-white"}),e.jsxs("div",{children:[e.jsx(h,{label:"Password",type:"password",name:"password",value:a.password,onChange:g,placeholder:"Enter your password",required:!0,icon:L,className:"bg-white"}),e.jsx("div",{className:"flex justify-end mt-1",children:e.jsx("a",{href:"#",className:"text-xs font-semibold text-green-600 hover:text-green-700",children:"Forgot password?"})})]}),e.jsx(C,{type:"submit",className:"w-full bg-slate-900 hover:bg-slate-800 text-white font-bold h-12 rounded-xl shadow-lg shadow-slate-200",isLoading:b,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:["Sign In",e.jsx(D,{size:16})]})})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-slate-50 text-center text-xs text-slate-400",children:"Need help? Contact your school administrator"})]})})};export{R as default};
