import{f as Z,u as ee,r as l,d as te,j as e,A as se,m as C,e as g}from"./vendor-Cr6tcs86.js";import{B as z}from"./index-41VSs_U4.js";import{B as ae,ar as B,ah as re,l as A,w as le,af as O,h as de,X as ie,j as ne,U as ce,O as oe,a7 as xe,s as me}from"./ui-BBn2VFCU.js";import{R as pe,B as ge,C as be,X as he,Y as ue,T as fe,d as je,c as ke}from"./charts-Fmv3L88u.js";const Se=()=>{const M=Z();ee();const[x,E]=l.useState("record"),[D,m]=l.useState(!1),[G,U]=l.useState([]),[v,$]=l.useState([]),[N,F]=l.useState([]),[r,j]=l.useState({grade_id:"",term:"1",type:"mid-term",date:new Date().toISOString().split("T")[0]}),[b,h]=l.useState(null),[k,w]=l.useState({}),[u,i]=l.useState(null),[K,P]=l.useState(!1),[y,X]=l.useState(""),[c,W]=l.useState(null);l.useEffect(()=>{(async()=>{try{const[s,a]=await Promise.all([g.get("/api/grades/"),g.get("/api/subjects/")]);U(s.data.grades||[]),$(a.data.subjects||[])}catch(s){console.error("Failed to load metadata",s)}})()},[]),l.useEffect(()=>{const t=new URLSearchParams(M.search),s=t.get("student"),a=t.get("grade"),n=t.get("term"),o=t.get("type"),d=t.get("edit");a&&j(p=>({...p,grade_id:a,term:n||p.term,type:o||p.type})),d==="true"&&s&&(sessionStorage.setItem("editMode","true"),sessionStorage.setItem("editStudentId",s),E("record"))},[M.search]),l.useEffect(()=>{x==="reports"&&r.grade_id&&r.term&&(async()=>{m(!0);try{const s=await g.get("/api/assessments/analytics/",{params:{grade_id:r.grade_id,term:r.term,type:r.type}});W(s.data.analytics||null)}catch(s){console.error("Failed to load analytics",s)}finally{m(!1)}})()},[x,r.grade_id,r.term,r.type]),l.useEffect(()=>{if(x!=="record"||!r.grade_id)return;F([]),(async()=>{m(!0);try{const s=await g.get(`/api/students/?grade=${r.grade_id}&per_page=1000`),a=s.data.students||s.data.results||[];F(a);const o=new URLSearchParams(M.search).get("student");if(o){const d=a.find(p=>p.id===parseInt(o));d&&I(d,a)}}catch(s){console.error("Failed to load students",s)}finally{m(!1)}})()},[r.grade_id,x]);const Y=(t,s)=>{if(s===""){w(a=>({...a,[t]:""}));return}w(a=>({...a,[t]:s}))},q=t=>{const s=parseFloat(t);return isNaN(s)?"-":s>=80?{label:"EE",class:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}:s>=60?{label:"ME",class:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}:s>=40?{label:"AE",class:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"}:{label:"BE",class:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}},I=async(t,s)=>{h(t),w({}),i(null),P(!1);const a=sessionStorage.getItem("editMode")==="true",n=sessionStorage.getItem("editStudentId");if(a&&(sessionStorage.removeItem("editMode"),sessionStorage.removeItem("editStudentId")),a&&n===t.id.toString()){console.log("Fetching existing marks for editing...");let o=v;if(o.length===0){console.log("Subjects not loaded yet, fetching...");try{o=(await g.get("/api/subjects/")).data.subjects||[],$(o)}catch(d){console.error("Failed to fetch subjects:",d),i({type:"error",text:"Failed to load subjects. Please refresh the page."});return}}try{const d=await g.get(`/api/students/${t.id}/academics/`);if(d.data.success&&d.data.records){const p=`Term ${r.term}`,L=d.data.records[p];if(L&&L[r.type]){const V=L[r.type],S={};V.subjects.forEach(_=>{const R=o.find(T=>T.name===_.subject_name||T.code===_.subject_code||T.name.toLowerCase()===_.subject_name.toLowerCase());R&&(S[R.id]=_.marks)}),Object.keys(S).length>0?(w(S),P(!0),i({type:"info",text:`Editing existing assessment. Loaded ${Object.keys(S).length} subject marks.`})):i({type:"error",text:"Could not load existing marks. Subject mismatch detected."})}else i({type:"error",text:`No existing ${r.type} assessment found for Term ${r.term}.`})}}catch(d){console.error("Error fetching existing marks:",d),i({type:"error",text:"Failed to load existing marks. Please try again."})}}},H=async()=>{if(!b||!r.grade_id)return;m(!0),i(null);const t=Object.entries(k).map(([a,n])=>({subject_id:a,marks:n})).filter(a=>a.marks!=="");if(t.length===0){i({type:"error",text:"Please enter at least one mark."}),m(!1);return}const s={student_id:b.id,grade_id:r.grade_id,term:r.term,assessment_type:r.type,date:r.date,results:t};try{const a=await g.post("/api/assessments/batch-save/",s);a.data.success&&(i({type:"success",text:`Saved ${a.data.saved_count} scores for ${b.full_name}!`}),setTimeout(()=>h(null),1500))}catch(a){console.error(a),i({type:"error",text:"Failed to save results. Please try again."})}finally{m(!1)}},J=()=>{const t=Object.values(k).map(a=>parseFloat(a)).filter(a=>!isNaN(a));if(t.length===0)return{total:0,average:0,count:0};const s=t.reduce((a,n)=>a+n,0);return{total:s,average:(s/t.length).toFixed(1),count:t.length}},Q=te.useMemo(()=>y?N.filter(t=>t.full_name.toLowerCase().includes(y.toLowerCase())||t.admission_number.toLowerCase().includes(y.toLowerCase())):N,[N,y]),f=J();return e.jsxs("div",{className:"p-4 max-w-7xl mx-auto space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-3 md:gap-4 pb-3 md:pb-4 border-b border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-black text-slate-900 dark:text-white tracking-tight leading-none uppercase tracking-widest",children:"Academics"}),e.jsx("p",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400 mt-1 md:mt-1.5 font-medium tracking-wide",children:"Manage assessments, record marks, and view analytics."})]}),e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-800 p-1 rounded-2xl flex items-center w-full md:w-auto",children:[e.jsxs("button",{onClick:()=>{E("record"),h(null)},className:`flex-1 md:flex-none flex items-center justify-center gap-2 px-3 md:px-5 py-2 rounded-xl text-[11px] md:text-xs font-black transition-all duration-200 uppercase tracking-widest ${x==="record"?"bg-white dark:bg-slate-700 text-primary-600 dark:text-white shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[e.jsx(ae,{size:14,className:"md:w-[16px] md:h-[16px]"}),"Record Marks"]}),e.jsxs("button",{onClick:()=>{E("reports"),h(null)},className:`flex-1 md:flex-none flex items-center justify-center gap-2 px-3 md:px-5 py-2 rounded-xl text-[11px] md:text-xs font-black transition-all duration-200 uppercase tracking-widest ${x==="reports"?"bg-white dark:bg-slate-700 text-primary-600 dark:text-white shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[e.jsx(B,{size:14,className:"md:w-[16px] md:h-[16px]"}),"Analytics"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-5 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 grid grid-cols-2 lg:flex lg:flex-wrap gap-3 md:gap-4 items-center",children:[e.jsx("div",{className:"col-span-2 lg:flex lg:items-center lg:gap-2 text-slate-500 dark:text-slate-400 md:mr-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{size:18,className:"md:w-5 md:h-5 text-primary-500"}),e.jsx("span",{className:"font-bold text-xs uppercase tracking-wider",children:"Filters:"})]})}),e.jsxs("div",{className:"relative col-span-2 sm:col-span-1 lg:min-w-[220px]",children:[e.jsxs("select",{className:"w-full pl-4 pr-10 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-primary-500 rounded-xl text-sm font-bold focus:ring-0 appearance-none text-slate-700 dark:text-slate-200 transition-all cursor-pointer",value:r.grade_id,onChange:t=>j(s=>({...s,grade_id:t.target.value})),children:[e.jsx("option",{value:"",children:"Select Class / Grade"}),G.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(A,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative col-span-1 lg:min-w-[180px]",children:[e.jsxs("select",{className:"w-full pl-4 pr-10 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-primary-500 rounded-xl text-sm font-bold focus:ring-0 appearance-none text-slate-700 dark:text-slate-200 transition-all cursor-pointer",value:r.type,onChange:t=>j(s=>({...s,type:t.target.value})),children:[e.jsx("option",{value:"opener",children:"Opener"}),e.jsx("option",{value:"mid-term",children:"Mid Term"}),e.jsx("option",{value:"end-term",children:"End Term"}),e.jsx("option",{value:"weekly",children:"Weekly"})]}),e.jsx(A,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative col-span-1 lg:min-w-[140px]",children:[e.jsxs("select",{className:"w-full pl-4 pr-10 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-primary-500 rounded-xl text-sm font-bold focus:ring-0 appearance-none text-slate-700 dark:text-slate-200 transition-all cursor-pointer",value:r.term,onChange:t=>j(s=>({...s,term:t.target.value})),children:[e.jsx("option",{value:"1",children:"Term 1"}),e.jsx("option",{value:"2",children:"Term 2"}),e.jsx("option",{value:"3",children:"Term 3"})]}),e.jsx(A,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"})]}),e.jsx("div",{className:"col-span-2 lg:ml-auto",children:e.jsx("input",{type:"date",value:r.date,onChange:t=>j(s=>({...s,date:t.target.value})),className:"w-full lg:w-auto px-4 py-3 md:py-2.5 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-primary-500 rounded-xl text-sm font-bold focus:ring-0 text-slate-700 dark:text-slate-200 transition-all cursor-pointer"})})]}),e.jsx(se,{mode:"wait",children:u&&e.jsxs(C.div,{initial:{opacity:0,y:-20,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,height:0},className:`px-4 py-3 rounded-lg flex items-center justify-between gap-4 ${u.type==="success"?"bg-green-50 text-green-700 border border-green-200 dark:bg-green-900/20 dark:border-green-800":u.type==="info"?"bg-blue-50 text-blue-700 border border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":"bg-red-50 text-red-700 border border-red-200 dark:bg-red-900/20 dark:border-red-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[u.type==="success"?e.jsx(le,{size:18}):u.type==="info"?e.jsx(O,{size:18}):e.jsx(de,{size:18}),u.text]}),e.jsx("button",{onClick:()=>i(null),className:"opacity-50 hover:opacity-100",children:e.jsx(ie,{size:16})})]})}),x==="record"&&e.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:[!b&&r.grade_id&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md mx-auto md:mx-0",children:[e.jsx(ne,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search student by name or admission...",className:"w-full pl-12 pr-4 py-3 bg-white dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 focus:border-primary-500 rounded-2xl text-sm font-bold focus:ring-0 text-slate-700 dark:text-slate-200 shadow-sm transition-all",value:y,onChange:t=>X(t.target.value)})]})}),b?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-4 md:p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col sm:flex-row justify-between items-center bg-slate-50/50 dark:bg-slate-800/50 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 md:gap-4 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors text-slate-500",children:e.jsx(A,{className:"rotate-90 w-5 h-5 md:w-6 md:h-6"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h2",{className:"text-lg md:text-xl font-black text-slate-900 dark:text-white flex flex-wrap items-center gap-2 truncate",children:[b.full_name,K&&e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-[10px] font-bold rounded-md uppercase tracking-wide",children:"Edit"})]}),e.jsxs("p",{className:"text-[10px] md:text-sm text-slate-500 mt-0.5 font-medium",children:["Recording ",e.jsx("span",{className:"text-primary-600 font-bold uppercase",children:r.type})," • T",r.term]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(z,{variant:"secondary",className:"flex-1 sm:flex-none py-2 text-xs",onClick:()=>h(null),children:"Cancel"}),e.jsxs(z,{className:"flex-[2] sm:flex-none py-2 text-xs shadow-lg shadow-primary-500/20",onClick:H,isLoading:D,children:[e.jsx(oe,{className:"mr-1.5 w-3.5 h-3.5 md:w-[18px] md:h-[18px]"}),"Save Grades"]})]})]}),e.jsx("div",{className:"p-6 md:p-8",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-6",children:v.map(t=>{const s=q(k[t.id]);return e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:t.name}),k[t.id]&&e.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${s.class}`,children:s.label})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:"0",max:"100",placeholder:"—",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 focus:ring-2 focus:ring-primary-500 focus:bg-white dark:focus:bg-slate-800 outline-none transition-all font-mono text-lg font-semibold text-center",value:k[t.id]||"",onChange:a=>Y(t.id,a.target.value)}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center text-slate-400 text-xs font-bold pointer-events-none",children:"/100"})]})]},t.id)})})})]}),e.jsx("div",{className:"space-y-4 md:space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-5 md:p-6 shadow-xl border border-slate-100 dark:border-slate-800 sticky top-6",children:[e.jsxs("h3",{className:"font-black text-slate-900 dark:text-white mb-4 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(xe,{className:"text-amber-500 w-[18px] h-[18px] md:w-5 md:h-5"}),"Performance Stats"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1",children:"Subjects Graded"}),e.jsxs("p",{className:"text-xl md:text-2xl font-black text-slate-900 dark:text-white",children:[f.count," ",e.jsxs("span",{className:"text-xs font-bold text-slate-400",children:["/ ",v.length]})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 h-1.5 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"bg-primary-500 h-full rounded-full transition-all duration-300",style:{width:`${f.count/v.length*100}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl text-center",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase mb-1",children:"Total"}),e.jsx("p",{className:"text-lg md:text-xl font-black text-slate-900 dark:text-white",children:f.total})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl text-center",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase mb-1",children:"Average"}),e.jsxs("p",{className:`text-lg md:text-xl font-black ${parseFloat(f.average)>=60?"text-green-600":parseFloat(f.average)>=40?"text-amber-600":"text-slate-900 dark:text-white"}`,children:[f.average,"%"]})]})]})]}),e.jsx("div",{className:"mt-5 pt-5 border-t border-slate-100 dark:border-slate-800",children:e.jsx("p",{className:"text-[10px] font-medium text-slate-400 text-center leading-relaxed",children:"Auto-calculates grade levels and totals upon saving."})})]})})]}):r.grade_id?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4",children:[Q.map((t,s)=>e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:s*.03},onClick:()=>I(t),className:"bg-white dark:bg-slate-900 p-3 md:p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800 hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-md transition-all cursor-pointer group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 md:p-4 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-primary-50 text-primary-600 rounded-full p-1",children:e.jsx(O,{size:12,className:"md:w-[14px] md:h-[14px]"})})}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-3 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"h-10 w-10 md:h-12 md:w-12 rounded-xl bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-800 dark:to-slate-700 flex items-center justify-center text-sm md:text-lg font-bold text-slate-500 uppercase shrink-0",children:t.photo?e.jsx("img",{src:t.photo,alt:"Student",className:"w-full h-full object-cover rounded-xl"}):t.full_name?.[0]||"S"}),e.jsxs("div",{className:"min-w-0 w-full",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white group-hover:text-primary-600 transition-colors text-xs md:text-base truncate",children:t.full_name}),e.jsxs("p",{className:"text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mt-0.5",children:["Adm: ",e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:t.admission_number})]}),e.jsx("div",{className:"mt-2 text-[10px] text-slate-400 hidden md:flex items-center gap-1",children:"Click to record marks"})]})]})]},t.id)),N.length===0&&e.jsx("div",{className:"col-span-full py-12 md:py-20 text-center text-slate-400 bg-slate-50 dark:bg-slate-900/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-800",children:"No students found in this class."})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-slate-50 dark:bg-slate-900/50 rounded-3xl border-2 border-dashed border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"h-16 w-16 bg-white dark:bg-slate-800 rounded-2xl flex items-center justify-center shadow-sm mb-4",children:e.jsx(ce,{size:32,className:"text-primary-500"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Select a Class"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 max-w-sm text-center",children:"Please select a Grade from the filters above to view the student list and start recording marks."})]})]}),x==="reports"&&e.jsx(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:c?e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-6",children:Object.entries(c.distribution).map(([t,s])=>{const a={exceeding:"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-400",meeting:"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",approaching:"text-amber-600 bg-amber-50 dark:bg-amber-900/20 dark:text-amber-400",below:"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400"},n={exceeding:{title:"Exceeding",desc:"80% - 100%"},meeting:{title:"Meeting",desc:"60% - 79%"},approaching:{title:"Approaching",desc:"40% - 59%"},below:{title:"Below",desc:"0% - 39%"}};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2 md:mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-xs md:text-base",children:n[t].title}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5 hidden md:block",children:n[t].desc})]}),e.jsxs("div",{className:`px-1.5 md:px-2.5 py-0.5 md:py-1 rounded-lg text-[10px] md:text-xs font-black uppercase ${a[t]}`,children:[(s/(c.merit_list.length||1)*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"text-2xl md:text-4xl font-black text-slate-900 dark:text-white my-1 md:my-2",children:s}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tighter",children:"Students"})]},t)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-900 p-5 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-lg font-black text-slate-900 dark:text-white mb-6",children:"Subject Performance"}),e.jsx("div",{className:"h-64 md:h-80 w-full",children:e.jsx(pe,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(ge,{data:c.subject_performance,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx(be,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(he,{dataKey:"subject__code",axisLine:!1,tickLine:!1,tick:{fill:"#64748b",fontSize:10},dy:10}),e.jsx(ue,{axisLine:!1,tickLine:!1,tick:{fill:"#64748b",fontSize:10}}),e.jsx(fe,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},cursor:{fill:"#f8fafc"}}),e.jsx(je,{dataKey:"avg_score",radius:[4,4,0,0],maxBarSize:40,children:c.subject_performance.map((t,s)=>e.jsx(ke,{fill:t.avg_score>=60?"#3b82f6":t.avg_score>=40?"#f59e0b":"#ef4444"},`cell-${s}`))})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-6",children:"Top Performers"}),e.jsxs("div",{className:"space-y-4",children:[c.merit_list.slice(0,5).map((t,s)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-xl transition-colors",children:[e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center font-bold text-sm border-2 shrink-0 ${s===0?"bg-yellow-50 border-yellow-200 text-yellow-700":s===1?"bg-slate-50 border-slate-200 text-slate-700":s===2?"bg-orange-50 border-orange-200 text-orange-700":"bg-transparent border-transparent text-slate-500"}`,children:s+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white truncate",children:t.full_name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.average,"% Average"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"font-mono font-bold text-primary-600",children:t.total_marks}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase",children:"Total"})]})]},t.id)),c.merit_list.length===0&&e.jsx("p",{className:"text-center text-slate-400 py-8",children:"No data available."})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-5 md:p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("h3",{className:"text-lg font-black text-slate-900 dark:text-white",children:"Merit List"}),e.jsx("p",{className:"text-xs md:text-sm text-slate-500 font-medium",children:"Complete class ranking based on assessment results"})]}),e.jsxs(z,{variant:"outline",size:"sm",className:"w-full md:w-auto rounded-xl",children:[e.jsx(me,{size:16,className:"mr-2 text-primary-500"}),"Download Report"]})]}),e.jsx("div",{className:"md:hidden divide-y divide-slate-100 dark:divide-slate-800",children:c.merit_list.map(t=>e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center h-10 w-8 font-mono text-sm font-black text-slate-400 dark:text-slate-600",children:["#",t.rank]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white truncate text-sm",children:t.full_name}),e.jsx("span",{className:`text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-tighter ${t.grade==="Exceeding"?"bg-emerald-50 text-emerald-600 border border-emerald-100":t.grade==="Meeting"?"bg-blue-50 text-blue-600 border border-blue-100":t.grade==="Approaching"?"bg-amber-50 text-amber-600 border border-amber-100":"bg-rose-50 text-rose-600 border border-rose-100"}`,children:t.grade})]}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-medium",children:[t.admission_number," • ",t.subjects_sat," Subjects"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-black text-slate-900 dark:text-white",children:[t.average,"%"]}),e.jsxs("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter",children:[t.total_marks," Pts"]})]})]},t.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-500 uppercase tracking-widest",children:"Rank"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-500 uppercase tracking-widest",children:"Student"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-black text-slate-500 uppercase tracking-widest",children:"Subjects"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-black text-slate-500 uppercase tracking-widest",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-black text-slate-500 uppercase tracking-widest",children:"Average"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-black text-slate-500 uppercase tracking-widest",children:"Level"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:c.merit_list.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 font-mono font-bold text-slate-500",children:["#",t.rank]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-xs font-bold text-slate-500 uppercase",children:t.full_name?.[0]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-sm",children:t.full_name}),e.jsx("p",{className:"text-xs text-slate-400 font-medium",children:t.admission_number})]})]})}),e.jsx("td",{className:"px-6 py-4 text-center text-slate-600 dark:text-slate-400 font-medium",children:t.subjects_sat}),e.jsx("td",{className:"px-6 py-4 text-right font-mono font-black text-primary-600",children:t.total_marks}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-slate-900 dark:text-white",children:[t.average,"%"]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-wide border ${t.grade==="Exceeding"?"bg-green-50 text-green-700 border-green-100":t.grade==="Meeting"?"bg-blue-50 text-blue-700 border-blue-100":t.grade==="Approaching"?"bg-yellow-50 text-yellow-700 border-yellow-100":"bg-red-50 text-red-700 border-red-100"}`,children:t.grade})})]},t.id))})]})})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-slate-50 dark:bg-slate-900/50 rounded-3xl border-2 border-dashed border-slate-200 dark:border-slate-800 text-center",children:[e.jsx("div",{className:"h-20 w-20 bg-white dark:bg-slate-800 rounded-full flex items-center justify-center shadow-sm mb-6",children:e.jsx(B,{size:40,className:"text-slate-300 dark:text-slate-600"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"No Analytics Data"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2 max-w-md",children:r.grade_id?"No assessment records found for the selected criteria. Try changing the filters or recording some marks first.":"Please select a Class and Term using the filters above to view the analysis report."})]})})]})};export{Se as default};
