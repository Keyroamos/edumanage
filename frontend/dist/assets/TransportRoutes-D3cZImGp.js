import{u as C,r,e as c,j as e}from"./vendor-Cr6tcs86.js";import{B as x}from"./index-wvMzqk1Z.js";import{$ as p,j as S,V as E,ai as R,E as z,J as P,U as D,X as M}from"./ui-BBn2VFCU.js";const K=()=>{const h=C(),[g,b]=r.useState([]),[f,j]=r.useState(!0),[o,v]=r.useState(""),[k,l]=r.useState(!1),[d,u]=r.useState(!1),[s,a]=r.useState({id:null,name:"",cost_per_term:"",cost_per_month:"",description:"",pickup_points:"",map_embed_code:""});r.useEffect(()=>{n()},[]);const n=async()=>{try{const t=await c.get("/api/transport/routes/");b(t.data.routes||[])}catch(t){console.error(t),b([])}finally{j(!1)}},w=async t=>{t.preventDefault();try{await c.post("/api/transport/routes/",{action:d?"UPDATE":"CREATE",...s}),l(!1),n(),i()}catch{alert("Failed to save route")}},N=async(t,m)=>{if(confirm(`Delete route "${m}"?`))try{await c.post("/api/transport/routes/",{action:"DELETE",id:t}),n()}catch{alert("Failed to delete route")}},_=t=>{a({id:t.id,name:t.name,cost_per_term:t.cost_per_term,cost_per_month:t.cost_per_month,description:t.description||"",pickup_points:t.pickup_points||"",map_embed_code:t.map_embed_code||""}),u(!0),l(!0)},i=()=>{a({id:null,name:"",cost_per_term:"",cost_per_month:"",description:"",pickup_points:"",map_embed_code:""}),u(!1)},y=(g||[]).filter(t=>t.name?.toLowerCase().includes(o.toLowerCase())||t.description?.toLowerCase().includes(o.toLowerCase()));return f?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in-up pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-2",children:"Transport Routes"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Manage available transport routes and pricing"})]}),e.jsxs(x,{onClick:()=>{i(),l(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-600/20",children:[e.jsx(p,{size:20,className:"mr-2"}),"Create New Route"]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search routes...",value:o,onChange:t=>v(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[y.map(t=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm border border-slate-100 dark:border-slate-700 group hover:shadow-md transition-all relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-50 dark:bg-blue-900/10 rounded-full blur-2xl -mr-10 -mt-10 pointer-events-none group-hover:bg-blue-100 dark:group-hover:bg-blue-900/20 transition-colors"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-xl",children:e.jsx(E,{size:24})}),e.jsxs("div",{className:"flex gap-2 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>h(`/transport-portal/routes/${t.id}`),className:"p-2 bg-white dark:bg-slate-700 text-slate-500 hover:text-indigo-600 rounded-lg shadow-sm border border-slate-200 dark:border-slate-600 transition-colors",title:"View Details",children:e.jsx(R,{size:16})}),e.jsx("button",{onClick:()=>_(t),className:"p-2 bg-white dark:bg-slate-700 text-slate-500 hover:text-blue-600 rounded-lg shadow-sm border border-slate-200 dark:border-slate-600 transition-colors",children:e.jsx(z,{size:16})}),e.jsx("button",{onClick:()=>N(t.id,t.name),className:"p-2 bg-white dark:bg-slate-700 text-slate-500 hover:text-red-600 rounded-lg shadow-sm border border-slate-200 dark:border-slate-600 transition-colors",children:e.jsx(P,{size:16})})]})]}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 line-clamp-2 h-10 mb-4",children:t.description||"No description provided."}),e.jsx("div",{className:"flex items-center gap-2 mb-4",children:t.student_count>0&&e.jsxs("span",{className:"px-2.5 py-1 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx(D,{size:12})," ",t.student_count," Students"]})}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Per Term"}),e.jsxs("span",{className:"text-lg font-black text-slate-800 dark:text-white font-mono",children:["KES ",t.cost_per_term.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Per Month"}),e.jsxs("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 font-mono",children:["KES ",t.cost_per_month.toLocaleString()]})]})]})]})]},t.id)),e.jsxs("button",{onClick:()=>{i(),l(!0)},className:"border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl p-6 flex flex-col items-center justify-center text-slate-400 hover:border-blue-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-slate-800/50 transition-all group min-h-[280px]",children:[e.jsx("div",{className:"mb-4 p-4 bg-slate-50 dark:bg-slate-800 rounded-full group-hover:scale-110 transition-transform",children:e.jsx(p,{size:32})}),e.jsx("span",{className:"font-bold text-lg",children:"Add New Route"})]})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl w-full max-w-lg shadow-2xl animate-scale-in overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-900 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:d?"Edit Route":"New Route"}),e.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(M,{size:24})})]}),e.jsx("div",{className:"p-6 md:p-8",children:e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Route Name"}),e.jsx("input",{type:"text",value:s.name,onChange:t=>a({...s,name:t.target.value}),required:!0,placeholder:"e.g. Route A - CBD",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Cost Per Term (KES)"}),e.jsx("input",{type:"number",value:s.cost_per_term,onChange:t=>a({...s,cost_per_term:t.target.value}),required:!0,placeholder:"0.00",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-blue-500 outline-none dark:text-white font-mono font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Cost Per Month (KES)"}),e.jsx("input",{type:"number",value:s.cost_per_month,onChange:t=>a({...s,cost_per_month:t.target.value}),placeholder:"0.00",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-blue-500 outline-none dark:text-white font-mono font-bold"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:t=>a({...s,description:t.target.value}),rows:"3",placeholder:"Describe the route coverage...",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-blue-500 outline-none dark:text-white resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Pickup Points"}),e.jsx("textarea",{value:s.pickup_points,onChange:t=>a({...s,pickup_points:t.target.value}),rows:"2",placeholder:"Comma-separated pickup points...",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-blue-500 outline-none dark:text-white resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Route Map Embed Code"}),e.jsx("textarea",{value:s.map_embed_code,onChange:t=>a({...s,map_embed_code:t.target.value}),rows:"3",placeholder:'Paste Google Maps embed code (e.g., <iframe src="..."></iframe>)',className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-blue-500 outline-none dark:text-white resize-none font-mono text-xs"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1 ml-1",children:"Paste the full iframe embed code from Google Maps"})]}),e.jsxs("div",{className:"pt-2 flex gap-3",children:[e.jsx(x,{type:"button",variant:"outline",className:"flex-1",onClick:()=>l(!1),children:"Cancel"}),e.jsx(x,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-600/20",children:d?"Update Route":"Create Route"})]})]})})]})})]})};export{K as default};
