import{r as i,d as H,e as v,j as e,A as P,m as g,u as xe}from"./vendor-Cr6tcs86.js";import me from"./Salaries-DE2x9DgF.js";import ue from"./TransportFinance-7o_wzUIt.js";import he from"./FoodFinance-BcxIswpA.js";import{u as Q,B as N}from"./index-41VSs_U4.js";import{ae as M,j as Z,w as ee,h as pe,O as be,X as q,af as ge,D as I,J as fe,B as je,$ as Y,ag as ye,W as K,U as ve,F as Ne,s as se,t as W,Y as ke,C as we,a9 as Ce,ah as Se,v as Fe,ai as _e}from"./ui-BBn2VFCU.js";import{R as V,A as Te,C as Ee,X as $e,Y as ze,T as X,a as J,P as Ae,b as Le,c as Re}from"./charts-Fmv3L88u.js";const De=()=>{const{config:l}=Q(),[d,F]=i.useState([]),[_,f]=i.useState([]),[n,T]=i.useState([]),[m,A]=i.useState(!0),[j,k]=i.useState(!1),[c,L]=i.useState(""),[w,E]=i.useState(null),[C,u]=i.useState(!1),[h,t]=i.useState(null),[o,$]=i.useState({}),[z,te]=i.useState("2024-2025"),[G,ae]=i.useState([]),[x,S]=i.useState({grade_id:"",term:"1",category_id:"",amount:"",is_mandatory:!0}),R=H.useMemo(()=>{const s={};return G.forEach(a=>{s[a]={1:[],2:[],3:[]}}),d.forEach(a=>{const r=a.grade;s[r]||(s[r]={1:[],2:[],3:[]}),s[r][a.term].push(a)}),s},[d,G]);i.useEffect(()=>{D()},[z]);const D=async()=>{A(!0);try{const[s,a,r]=await Promise.all([v.get(`/api/finance/fee-structures/?year=${z}`),v.get("/api/finance/fee-categories/"),v.get("/api/grades/")]),p=s.data.fee_structures||[];F(p);const B=r.data.grades||[];T(B),ae(B.map(ce=>ce.code)),f(a.data.categories||[])}catch(s){console.error("Error fetching data:",s),y("error","Failed to load fee structures")}finally{A(!1)}},le=async s=>{s&&s.preventDefault(),k(!0);try{await v.post("/api/finance/fee-structures/create/",{...x,academic_year:z}),y("success","Fee item added successfully"),u(!1),S({grade_id:"",term:"1",category_id:"",amount:"",is_mandatory:!0}),await D()}catch(a){console.error("Failed to add fee",a),y("error",a.response?.data?.error||"Failed to add fee item")}finally{k(!1)}},y=(s,a)=>{E({type:s,text:a}),setTimeout(()=>E(null),4e3)},re=(s,a)=>{t(s);const r={};Object.values(a).flat().forEach(p=>{r[p.id]=p.amount}),$(r)},ie=()=>{t(null),$({})},de=(s,a)=>{$(r=>({...r,[s]:a}))},ne=async s=>{k(!0);try{const a=Object.entries(o).map(([p,B])=>({id:parseInt(p),amount:parseFloat(B)})),r=await v.post("/api/finance/fee-structures/update/",{updates:a});y("success",`Updated ${s} fees. ${r.data.updated_students||0} students synced.`),await D(),t(null)}catch(a){console.error("Failed to update fees",a),y("error","Failed to update fees")}finally{k(!1)}},oe=async s=>{if(confirm("Are you sure you want to delete this fee item?"))try{await v.delete(`/api/finance/fee-structures/${s}/`),y("success","Fee item deleted successfully"),await D()}catch{y("error","Failed to delete fee item")}},U=G.filter(s=>s.toLowerCase().includes(c.toLowerCase()));return m?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"w-12 h-12 animate-spin text-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading fee structures..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Fee Structure Management"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Configure school fees by class, term, and category"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search class...",value:c,onChange:s=>L(s.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-64 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-sm outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("select",{value:z,onChange:s=>te(s.target.value),className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"2024-2025",children:"2024-2025"}),e.jsx("option",{value:"2025-2026",children:"2025-2026"}),e.jsx("option",{value:"2026-2027",children:"2026-2027"})]})]})]}),e.jsx(P,{children:w&&e.jsxs(g.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center gap-3 ${w.type==="success"?"bg-emerald-50 text-emerald-700 border border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-400":"bg-red-50 text-red-700 border border-red-200 dark:bg-red-900/20 dark:text-red-400"}`,children:[w.type==="success"?e.jsx(ee,{size:20}):e.jsx(pe,{size:20}),e.jsx("span",{className:"font-medium",children:w.text})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:U.map(s=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-900 rounded-xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-slate-900 dark:text-white tracking-tight",children:s}),e.jsxs("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mt-1",children:["Academic Year ",z]})]}),h===s?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ne(s),disabled:j,className:"p-2 rounded-lg bg-emerald-500 hover:bg-emerald-600 text-white shadow transition-colors disabled:opacity-50",children:j?e.jsx(M,{size:16,className:"animate-spin"}):e.jsx(be,{size:16})}),e.jsx("button",{onClick:ie,className:"p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(q,{size:16})})]}):e.jsx("button",{onClick:()=>re(s,R[s]),className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-800 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:e.jsx(ge,{size:16})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[1,2,3].map(a=>e.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-800/30 rounded-lg p-3 border border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest",children:["Term ",a]}),e.jsx(I,{size:12,className:"text-slate-400"})]}),e.jsx("div",{className:"space-y-3 min-h-[60px]",children:R[s][a]&&R[s][a].length>0?R[s][a].map(r=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase leading-none",children:r.category}),h===s?e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-slate-400",children:l.currency}),e.jsx("input",{type:"number",value:o[r.id]||0,onChange:p=>de(r.id,p.target.value),className:"w-full pl-8 pr-2 py-1.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-xs font-bold outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-all shadow-sm"})]}):e.jsxs("div",{className:"flex items-center justify-between group/fee",children:[e.jsxs("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:[l.currency," ",r.amount.toLocaleString()]}),e.jsx("button",{onClick:()=>oe(r.id),className:"opacity-0 group-hover/fee:opacity-100 p-1 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-500/10 rounded transition-all",children:e.jsx(fe,{size:12})})]})]},r.id)):e.jsx("span",{className:"text-[10px] italic text-slate-400",children:"No fees configured"})})]},a))})]},s))}),U.length===0&&e.jsxs("div",{className:"text-center py-16 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx(je,{className:"w-16 h-16 text-slate-300 dark:text-slate-700 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:c?"No classes found matching your search":"No fee structures configured yet"}),e.jsxs(N,{onClick:()=>u(!0),className:"mt-4 bg-indigo-600 hover:bg-indigo-700 text-white border-none",children:[e.jsx(Y,{size:18,className:"mr-2"}),"Add First Fee Structure"]})]}),e.jsx(P,{children:C&&e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>u(!1),className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm"}),e.jsxs(g.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Add Fee Item"}),e.jsx("p",{className:"text-xs font-medium text-slate-500 mt-1",children:"Assign a fee category to a class and term"})]}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 rounded-xl text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all font-bold",children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:le,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Select Class"}),e.jsxs("select",{required:!0,value:x.grade_id,onChange:s=>S({...x,grade_id:s.target.value}),className:"w-full p-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all",children:[e.jsx("option",{value:"",children:"Choose Grade..."}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Term"}),e.jsxs("select",{required:!0,value:x.term,onChange:s=>S({...x,term:s.target.value}),className:"w-full p-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all",children:[e.jsx("option",{value:"1",children:"Term 1"}),e.jsx("option",{value:"2",children:"Term 2"}),e.jsx("option",{value:"3",children:"Term 3"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Fee Category"}),e.jsxs("select",{required:!0,value:x.category_id,onChange:s=>S({...x,category_id:s.target.value}),className:"w-full p-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all",children:[e.jsx("option",{value:"",children:"Choose Category..."}),_.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:["Amount (",l.currency,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-sm",children:l.currency}),e.jsx("input",{required:!0,type:"number",placeholder:"0.00",value:x.amount,onChange:s=>S({...x,amount:s.target.value}),className:"w-full pl-12 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-bold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("input",{type:"checkbox",id:"is_mandatory",checked:x.is_mandatory,onChange:s=>S({...x,is_mandatory:s.target.checked}),className:"w-5 h-5 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_mandatory",className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Mandatory fee (Automatically billed to students)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>u(!1),className:"flex-1 h-12 rounded-xl text-sm font-bold border-slate-200",children:"Cancel"}),e.jsx(N,{type:"submit",disabled:j,className:"flex-1 h-12 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl text-sm font-bold shadow-lg shadow-indigo-600/20 border-none",children:j?e.jsx(M,{size:18,className:"animate-spin"}):"Save Fee Item"})]})]})]})]})})]})},O=["#6366f1","#10b981","#f59e0b","#ef4444","#8b5cf6"],b=({title:l,value:d,subtext:F,icon:_,color:f,trend:n,delay:T,net:m})=>e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:T,duration:.4},className:"bg-white dark:bg-slate-900 p-5 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:items-start sm:justify-between sm:text-left gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center sm:items-start gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center sm:flex-row gap-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${f} bg-opacity-10 dark:bg-opacity-20`,children:e.jsx(_,{size:18,className:`${f.replace("bg-","text-")} dark:text-opacity-90`})}),e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:l})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-2xl font-semibold tracking-tight ${m?d.includes("-")?"text-rose-600":"text-emerald-600":"text-slate-900 dark:text-white"}`,children:d}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1 font-medium",children:F})]})]}),n!==void 0&&e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-md text-[11px] font-semibold ${n>=0?"text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10":"text-rose-600 bg-rose-50 dark:bg-rose-500/10"}`,children:[n>=0?e.jsx(se,{size:12}):e.jsx(W,{size:12}),e.jsxs("span",{children:[Math.abs(n),"%"]})]})]})}),We=()=>{const{config:l}=Q();xe();const[d,F]=i.useState(null),[_,f]=i.useState(!0),[n,T]=i.useState("overview"),[m,A]=i.useState(""),j=H.useMemo(()=>!d||!d.recent_collections?[]:d.recent_collections.filter(t=>t.student.toLowerCase().includes(m.toLowerCase())||t.reference.toLowerCase().includes(m.toLowerCase())||t.admission_no.toLowerCase().includes(m.toLowerCase())),[d,m]);i.useEffect(()=>{k()},[]);const k=async()=>{f(!0);try{const t=await v.get("/api/finance/");F(t.data)}catch(t){console.error("Error fetching finance:",t)}finally{f(!1)}};if(_)return e.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-50 dark:bg-slate-950",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 rounded-full border-4 border-slate-200 dark:border-slate-800 border-t-indigo-600 animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center font-black text-[10px] tracking-widest text-indigo-600 animate-pulse",children:"SYNCING"})]})});if(!d)return null;const c=d.summary||{},L=d.chart_data||[];d.recent_collections;const w=d.recent_expenses||[],E=c.total_expenses||0,C=c.expense_breakdown||{},u=[{name:"Salaries",value:C.salaries||0},{name:"Transport",value:C.transport||0},{name:"Food",value:C.food||0},{name:"Other",value:C.other||0}].filter(t=>t.value>0),h=({id:t,label:o,icon:$})=>e.jsxs("button",{onClick:()=>T(t),className:`flex items-center gap-2 px-4 py-2 text-sm font-semibold transition-all rounded-lg whitespace-nowrap ${n===t?"text-indigo-600 bg-indigo-50 dark:text-indigo-400 dark:bg-indigo-900/30":"text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[e.jsx($,{size:16}),o]});return e.jsxs("div",{className:"p-4 md:p-8 max-w-[1400px] mx-auto space-y-6 min-h-screen bg-slate-50/50 dark:bg-slate-950/20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 pb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white tracking-tight",children:"Finance Management"}),e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Manage fees, payroll, and school expenditures"})]}),e.jsxs("div",{className:"flex bg-white dark:bg-slate-900 p-1 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-x-auto no-scrollbar gap-1",children:[e.jsx(h,{id:"overview",label:"Overview",icon:ye}),e.jsx(h,{id:"collections",label:"Collections",icon:K}),e.jsx(h,{id:"fee-structure",label:"Fee Structure",icon:I}),l.subscription?.plan!=="Basic"&&e.jsxs(e.Fragment,{children:[e.jsx(h,{id:"payroll",label:"Payroll",icon:ve}),e.jsx(h,{id:"expenses",label:"Expenses",icon:Ne})]})]})]}),e.jsxs(P,{mode:"wait",children:[n==="overview"&&e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"space-y-6",children:[e.jsxs("div",{className:`grid grid-cols-2 ${l.subscription?.plan==="Basic"?"lg:grid-cols-2":"lg:grid-cols-4"} gap-4`,children:[e.jsx(b,{title:"Net Balance",value:`${l.currency} ${((c.net_profit||0)/1e3).toFixed(1)}k`,subtext:"Income - Expenses",icon:I,color:"bg-indigo-600",net:!0,delay:0}),e.jsx(b,{title:"Total Income",value:`${l.currency} ${((c.total_revenue||0)/1e3).toFixed(1)}k`,subtext:"Fees & others",icon:se,color:"bg-emerald-600",trend:12,delay:.1}),l.subscription?.plan!=="Basic"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Total Expenses",value:`${l.currency} ${(E/1e3).toFixed(1)}k`,subtext:"Salaries & Ops",icon:W,color:"bg-rose-600",delay:.2}),e.jsx(b,{title:"Runway",value:`${c.runway||0} Mo`,subtext:"Burn rate based",icon:ke,color:"bg-amber-600",delay:.3})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Cash Flow"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Revenue vs Expenditure"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-4 text-[11px] font-semibold text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),"Income"]}),l.subscription?.plan!=="Basic"&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-rose-500"}),"Expenses"]})]}),e.jsxs("select",{className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-semibold text-slate-600 dark:text-slate-300 p-2 outline-none",children:[e.jsx("option",{children:"This Year"}),e.jsx("option",{children:"Last Year"})]})]})]}),e.jsx("div",{className:"h-[350px] w-full",children:L.length>0?e.jsx(V,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(Te,{data:L,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorIncome",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#4f46e5",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#4f46e5",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorExpense",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f43f5e",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#f43f5e",stopOpacity:0})]})]}),e.jsx(Ee,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx($e,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#94a3b8",fontSize:10,fontWeight:600},dy:10}),e.jsx(ze,{axisLine:!1,tickLine:!1,tick:{fill:"#94a3b8",fontSize:10,fontWeight:600},tickFormatter:t=>`${t/1e3}k`}),e.jsx(X,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),e.jsx(J,{type:"monotone",dataKey:"revenue",stroke:"#4f46e5",strokeWidth:3,fill:"url(#colorIncome)"}),l.subscription?.plan!=="Basic"&&e.jsx(J,{type:"monotone",dataKey:"expenses",stroke:"#f43f5e",strokeWidth:3,fill:"url(#colorExpense)"})]})}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-400 font-medium text-sm",children:"No data available"})})]}),l.subscription?.plan!=="Basic"&&e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:"Expenses"}),e.jsx("p",{className:"text-xs font-medium text-slate-500 mb-6",children:"By Category"}),e.jsxs("div",{className:"h-64 relative w-full mb-6",children:[e.jsx(V,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(Ae,{children:[e.jsx(Le,{data:u,innerRadius:60,outerRadius:80,paddingAngle:4,dataKey:"value",cornerRadius:4,children:u.map((t,o)=>e.jsx(Re,{fill:O[o%O.length]},`cell-${o}`))}),e.jsx(X,{})]})}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col pointer-events-none",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Total"}),e.jsxs("span",{className:"text-xl font-bold text-slate-900 dark:text-white",children:[(E/1e3).toFixed(0),"k"]})]})]}),e.jsx("div",{className:"space-y-3",children:(u||[]).map((t,o)=>e.jsxs("div",{className:"flex justify-between items-center text-xs font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:O[o%O.length]}}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:t.name})]}),e.jsxs("span",{className:"text-slate-900 dark:text-white uppercase",children:[l.currency," ",t.value.toLocaleString()]})]},o))})]})]})]},"overview"),n==="collections"&&e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(b,{title:"Total Collected",value:`${l.currency} ${((c.total_revenue||0)/1e3).toFixed(1)}k`,subtext:"Total revenue",icon:K,color:"bg-emerald-600"}),e.jsx(b,{title:"Expected Fees",value:`${l.currency} ${((c.expected_fees||0)/1e3).toFixed(1)}k`,subtext:"Total billings",icon:we,color:"bg-blue-600"}),e.jsx(b,{title:"Outstanding",value:`${l.currency} ${((c.fees_arrears||0)/1e3).toFixed(1)}k`,subtext:"Unpaid total",icon:W,color:"bg-red-600"}),e.jsx(b,{title:"Collection Rate",value:`${c.collection_rate||0}%`,subtext:"Target: 85%",icon:Ce,color:"bg-violet-600"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col xl:flex-row xl:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white tracking-tight",children:"Recent Collections"}),e.jsx("p",{className:"text-xs font-medium text-slate-500 mt-1",children:"Real-time ledger of incoming fee payments"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{placeholder:"Search by student, admission or ref...",className:"pl-9 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm font-medium text-slate-600 dark:text-slate-300 outline-none w-full sm:w-64 focus:ring-2 focus:ring-indigo-500/20 transition-all",value:m,onChange:t=>A(t.target.value)})]}),e.jsxs(N,{variant:"outline",className:"h-9 px-3 text-xs font-semibold",children:[e.jsx(Se,{size:14,className:"mr-2"})," Filter"]}),e.jsxs(N,{variant:"primary",className:"h-9 px-4 text-xs font-semibold bg-indigo-600 border-none shadow-sm",children:[e.jsx(Y,{size:14,className:"mr-2"})," Record Payment"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800",children:e.jsxs("tr",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Student"}),e.jsx("th",{className:"px-6 py-4",children:"Reference"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4",children:"Channel"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:(j||[]).length>0?j.map((t,o)=>e.jsxs("tr",{className:"group hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-indigo-600 font-bold text-xs ring-1 ring-slate-200 dark:ring-slate-700",children:t.student[0]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:t.student}),e.jsxs("p",{className:"text-[10px] font-medium text-slate-500",children:["ADM: ",t.admission_no]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-xs font-mono font-medium text-slate-500 bg-slate-50/50 dark:bg-slate-800/50 px-2 py-1 rounded-md border border-slate-100 dark:border-slate-800",children:t.reference})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-bold text-emerald-600",children:[l.currency," ",t.amount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider ${t.method==="MPESA"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-blue-50 text-blue-600 border border-blue-100"}`,children:t.method})}),e.jsx("td",{className:"px-6 py-4 text-xs font-medium text-slate-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100",children:[e.jsx(ee,{size:10})," Verified"]})})]},o)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-8 py-16 text-center text-slate-400 font-medium",children:"No results found"})})})]})})]})]},"collections"),n==="expenses"&&e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white tracking-tight",children:"Expenditure Ledger"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Detailed record of school outflows"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{variant:"primary",className:"h-9 px-4 text-xs font-semibold bg-rose-600 border-none shadow-sm",children:[e.jsx(Y,{size:14,className:"mr-2"})," Record Expense"]}),e.jsxs(N,{variant:"outline",className:"h-9 px-3 text-xs font-semibold",children:[e.jsx(Fe,{size:14,className:"mr-2"})," Export"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800",children:e.jsxs("tr",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Title"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4",children:"Payee"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:(w||[]).map((t,o)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-sm text-slate-900 dark:text-white",children:t.title}),e.jsx("td",{className:"px-6 py-4 text-[10px] font-bold uppercase tracking-wider text-slate-500",children:t.category}),e.jsxs("td",{className:"px-6 py-4 text-sm font-bold text-rose-600",children:[l.currency," ",t.amount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-xs font-medium text-slate-500",children:t.vendor||"Staff"}),e.jsx("td",{className:"px-6 py-4 text-xs font-medium text-slate-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{className:"p-1.5 rounded bg-slate-100 dark:bg-slate-800 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(_e,{size:14})})})]},o))})]})})]})},"expenses"),n==="fee-structure"&&e.jsx(De,{}),n==="payroll"&&e.jsx(me,{}),n==="transport"&&e.jsx(ue,{}),n==="food"&&e.jsx(he,{})]})]})};export{We as default};
