import{r as l,e as y,j as e}from"./vendor-Cr6tcs86.js";import{aB as x,D as C,h as S,U as A,s as R,Y as m,r as z,aJ as T,q as $,w as E,c as L}from"./ui-BBn2VFCU.js";import{R as h,B as U,X as B,Y as D,T as g,d as P,c as b,P as _,b as K}from"./charts-Fmv3L88u.js";const F=()=>{const[a,p]=l.useState(null),[f,u]=l.useState(!0),[j,k]=l.useState("today");l.useEffect(()=>{N()},[]);const N=async()=>{try{const t=await y.get("/api/food/dashboard/");p(t.data)}catch(t){console.error(t)}finally{u(!1)}};if(f)return e.jsx("div",{className:"h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-orange-50 dark:from-slate-900 dark:to-slate-800",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-orange-200 border-t-orange-600"}),e.jsx(x,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-orange-600",size:24})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 font-medium animate-pulse",children:"Loading dashboard..."})]})});if(!a)return e.jsx("div",{className:"p-8 text-center",children:"No data available"});const s=a.stats||{},o=s.billed||0,v=s.collected||0,d=o>0?(v/o*100).toFixed(1):0,n=100-d,w=[{title:"Total Collected",value:`KES ${(s.collected||0).toLocaleString()}`,icon:C,trend:"+12.5%",trendUp:!0,bgGradient:"from-emerald-500 to-teal-600",iconBg:"bg-emerald-100 dark:bg-emerald-900/30",iconColor:"text-emerald-600 dark:text-emerald-400"},{title:"Outstanding",value:`KES ${(s.outstanding||0).toLocaleString()}`,icon:S,trend:"-5.2%",trendUp:!1,bgGradient:"from-red-500 to-pink-600",iconBg:"bg-red-100 dark:bg-red-900/30",iconColor:"text-red-600 dark:text-red-400"},{title:"Active Subscribers",value:s.active_subscribers||0,icon:A,trend:"+8 new",trendUp:!0,bgGradient:"from-blue-500 to-indigo-600",iconBg:"bg-blue-100 dark:bg-blue-900/30",iconColor:"text-blue-600 dark:text-blue-400"},{title:"Today's Revenue",value:`KES ${(s.todays_revenue||0).toLocaleString()}`,icon:R,trend:"Live",trendUp:!0,bgGradient:"from-orange-500 to-amber-600",iconBg:"bg-orange-100 dark:bg-orange-900/30",iconColor:"text-orange-600 dark:text-orange-400"}],i=[{name:"Collected",value:parseFloat(d),color:"#10b981"},{name:"Outstanding",value:parseFloat(n),color:"#ef4444"}],c=["#f97316","#fb923c","#fdba74","#fed7aa","#ffedd5"];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-orange-50/30 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 pb-20",children:[e.jsxs("div",{className:"mb-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-600/10 to-amber-600/10 dark:from-orange-600/5 dark:to-amber-600/5"}),e.jsx("div",{className:"relative px-6 py-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black text-slate-900 dark:text-white mb-2 tracking-tight",children:"Food Management"}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(m,{size:16,className:"text-orange-500"}),"Overview of cafeteria subscriptions and finances"]})]}),e.jsx("div",{className:"flex gap-2 bg-white dark:bg-slate-800 p-1.5 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:["Today","Week","Month"].map(t=>e.jsx("button",{onClick:()=>k(t.toLowerCase()),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${j===t.toLowerCase()?"bg-orange-600 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:t},t))})]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map((t,r)=>e.jsxs("div",{className:"group relative bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg shadow-slate-200/50 dark:shadow-none border border-slate-100 dark:border-slate-700 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${t.bgGradient} opacity-5 rounded-full blur-2xl -mr-10 -mt-10 group-hover:opacity-10 transition-opacity`}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 ${t.iconBg} rounded-xl`,children:e.jsx(t.icon,{size:24,className:t.iconColor})}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold ${t.trendUp?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:[t.trendUp?e.jsx(z,{size:12}):e.jsx(T,{size:12}),t.trend]})]}),e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400 mb-1",children:t.title}),e.jsx("p",{className:"text-3xl font-black text-slate-900 dark:text-white tracking-tight",children:t.value})]})]},r))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg shadow-slate-200/50 dark:shadow-none border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(x,{size:20,className:"text-orange-500"}),"Popular Meal Plans"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Active subscriptions by meal type"})]})}),e.jsx("div",{className:"h-80",children:e.jsx(h,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(U,{data:(a.popular_plans||[]).length>0?a.popular_plans:[{name:"N/A",value:0}],margin:{top:20,right:30,left:0,bottom:60},children:[e.jsx(B,{dataKey:"name",angle:-45,textAnchor:"end",height:100,tick:{fill:"#64748b",fontSize:12,fontWeight:600}}),e.jsx(D,{tick:{fill:"#64748b",fontSize:12}}),e.jsx(g,{contentStyle:{backgroundColor:"#1e293b",border:"none",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",color:"#fff"},cursor:{fill:"rgba(249, 115, 22, 0.1)"}}),e.jsx(P,{dataKey:"value",radius:[8,8,0,0],children:((a.popular_plans||[]).length>0?a.popular_plans:[{value:0}]).map((t,r)=>e.jsx(b,{fill:c[r%c.length]},`cell-${r}`))})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg shadow-slate-200/50 dark:shadow-none border border-slate-100 dark:border-slate-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2 mb-6",children:[e.jsx(m,{size:20,className:"text-orange-500"}),"Collection Rate"]}),e.jsx("div",{className:"h-64",children:e.jsx(h,{width:"100%",height:"100%",children:e.jsxs(_,{children:[e.jsx(K,{data:i,cx:"50%",cy:"50%",innerRadius:60,outerRadius:90,paddingAngle:5,dataKey:"value",children:i.map((t,r)=>e.jsx(b,{fill:t.color},`cell-${r}`))}),e.jsx(g,{contentStyle:{backgroundColor:"#1e293b",border:"none",borderRadius:"12px",color:"#fff"},formatter:t=>`${t}%`})]})})}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:"Collected"})]}),e.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[d,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:"Outstanding"})]}),e.jsxs("span",{className:"text-sm font-black text-red-600 dark:text-red-400",children:[n,"%"]})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg shadow-slate-200/50 dark:shadow-none border border-slate-100 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700 bg-gradient-to-r from-orange-50/50 to-transparent dark:from-orange-900/10",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx($,{size:20,className:"text-orange-500"}),"Recent Activity"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Latest food transactions"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50",children:e.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-700/50",children:(a.recent_transactions||[]).map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/40 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"font-bold text-slate-900 dark:text-white",children:t.student})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-bold ${t.type==="PAYMENT"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"}`,children:[t.type==="PAYMENT"?e.jsx(E,{size:12}):e.jsx(L,{size:12}),t.type]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.description})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono",children:t.date})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("p",{className:`font-mono font-black text-sm ${t.type==="PAYMENT"?"text-emerald-600 dark:text-emerald-400":"text-slate-800 dark:text-slate-300"}`,children:[t.type==="PAYMENT"?"+":"-"," KES ",t.amount.toLocaleString()]})})]},t.id))})]}),(a.recent_transactions||[]).length===0&&e.jsx("div",{className:"py-8 px-6 text-left border-t border-slate-100 dark:border-slate-700",children:e.jsx("p",{className:"text-slate-400 text-xs italic",children:"No catering ledger entries found for this period."})})]})]})]})]})};export{F as default};
