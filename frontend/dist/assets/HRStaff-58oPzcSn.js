import{u as L,r as d,e as b,j as e,m as T}from"./vendor-Cr6tcs86.js";import{B as c,I as _}from"./index-DR2ymqTX.js";import{b as f,J as N,u as $,$ as v,j as I,U as R,C as w,ab as z,at as V,ai as D,E as O,a3 as U,a4 as P}from"./ui-BBn2VFCU.js";const B=({staff:s,onView:l,onEdit:x,onDelete:h})=>{const[o,r]=d.useState(!1),m=n=>{switch(n){case"ACTIVE":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"ON_LEAVE":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400";case"INACTIVE":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";default:return"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-400"}};return e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5 md:p-6 hover:shadow-lg transition-all relative group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[e.jsxs("div",{className:"h-14 w-14 md:h-16 md:w-16 rounded-2xl bg-indigo-50 dark:bg-indigo-900/20 flex items-center justify-center text-indigo-600 dark:text-indigo-400 font-bold text-xl border border-indigo-100 dark:border-indigo-800/50",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base md:text-lg font-bold text-slate-900 dark:text-white leading-tight",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-widest mt-1 uppercase",children:s.staff_type_display})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>r(!o),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors bg-slate-50 dark:bg-slate-800/50",children:e.jsx(V,{size:18,className:"text-slate-400"})}),o&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-100 dark:border-slate-800 py-2 z-20",children:[e.jsxs("button",{onClick:()=>{l(s),r(!1)},className:"w-full px-4 py-2.5 text-left text-sm font-bold text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 flex items-center gap-3 transition-colors",children:[e.jsx(D,{size:16,className:"text-indigo-500"})," View Details"]}),e.jsxs("button",{onClick:()=>{x(s),r(!1)},className:"w-full px-4 py-2.5 text-left text-sm font-bold text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 flex items-center gap-3 transition-colors",children:[e.jsx(O,{size:16,className:"text-indigo-500"})," Edit Profile"]}),e.jsx("div",{className:"h-px bg-slate-100 dark:bg-slate-800 my-1 mx-4"}),e.jsxs("button",{onClick:()=>{h(s),r(!1)},className:"w-full px-4 py-2.5 text-left text-sm font-bold text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/10 flex items-center gap-3 transition-colors",children:[e.jsx(N,{size:16})," Delete Record"]})]})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs font-bold text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-800/50 p-2 rounded-xl border border-slate-100 dark:border-slate-800/50",children:[e.jsx(U,{size:14,className:"text-indigo-500"}),e.jsx("span",{children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-bold text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-800/50 p-2 rounded-xl border border-slate-100 dark:border-slate-800/50",children:[e.jsx(P,{size:14,className:"text-indigo-500"}),e.jsx("span",{className:"truncate",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-bold text-slate-500 dark:text-slate-400",children:[e.jsx(w,{size:14,className:"text-indigo-500"}),e.jsxs("span",{children:["Joined: ",new Date(s.date_joined).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-5 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("span",{className:`px-3 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider ${m(s.status)}`,children:s.status}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:"Salary"}),e.jsxs("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:["KES ",parseFloat(s.basic_salary).toLocaleString()]})]})]})]})},G=()=>{const s=L(),[l,x]=d.useState([]),[h,o]=d.useState(!0),[r,m]=d.useState(""),[n,k]=d.useState("ALL"),[u,y]=d.useState("ALL");d.useEffect(()=>{g()},[]);const g=async()=>{try{const t=await b.get("/api/hr/staff/");x(t.data.staff)}catch(t){console.error("Error fetching staff:",t)}finally{o(!1)}},A=t=>{t.is_teacher?s(`/teachers/${t.id}`):t.is_driver?s(`/transport-portal/drivers/${t.id}`):s(`/hr/staff/${t.id}`)},S=t=>{t.is_teacher?s(`/teachers/${t.id}`):t.is_driver?s(`/transport-portal/drivers/${t.id}`):s(`/hr/staff/${t.id}/edit`)},E=async t=>{let a=`/api/hr/staff/${t.id}/delete/`,i=`Are you sure you want to delete ${t.first_name} ${t.last_name}?`;if(t.is_teacher?(a=`/api/teachers/${t.id}/`,i=`Are you sure you want to delete Teacher ${t.first_name} ${t.last_name}? This will also delete their user account.`):t.is_driver&&(a=`/api/transport/drivers/${t.id}/`,i=`Are you sure you want to delete Driver ${t.first_name} ${t.last_name}?`),window.confirm(i))try{await b.delete(a),g()}catch(p){alert(p.response?.data?.error||"Error deleting staff member")}},C=async()=>{if(window.confirm("CRITICAL WARNING: You are about to delete ALL staff members (Teachers, Drivers, and Non-teaching staff). This will also delete their associated user accounts and cannot be undone. Are you absolutely sure?")&&window.confirm("Final Confirmation: Removal of all institutional staff is a destructive action. Proceed?"))try{await b.delete("/api/hr/staff/bulk-delete/"),g()}catch(i){alert(i.response?.data?.error||"Failed to delete all staff")}},j=l.filter(t=>{const a=`${t.first_name} ${t.last_name} ${t.email}`.toLowerCase().includes(r.toLowerCase()),i=n==="ALL"||t.staff_type===n,p=u==="ALL"||t.status===u;return a&&i&&p});return h?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsx("div",{className:"p-6 md:p-8 bg-slate-50 dark:bg-slate-950 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-14 w-14 md:h-16 md:w-16 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-500/20",children:e.jsx(f,{size:28,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight",children:"Staff Management"}),e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-widest mt-1",children:"Manage non-teaching staff members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(c,{variant:"outline",className:"flex-1 md:flex-none h-11 md:h-12 rounded-xl font-bold text-xs text-red-600 border-red-100 hover:bg-red-50",onClick:C,children:[e.jsx(N,{size:18,className:"mr-2"})," Delete All"]}),e.jsxs(c,{variant:"outline",className:"flex-1 md:flex-none h-11 md:h-12 rounded-xl font-bold text-xs",onClick:()=>s("/hr/staff/import"),children:[e.jsx($,{size:18,className:"mr-2 text-indigo-500"})," Import"]}),e.jsxs(c,{className:"flex-1 md:flex-none h-11 md:h-12 rounded-xl font-bold text-xs bg-indigo-600 shadow-lg shadow-indigo-500/10",onClick:()=>s("/hr/staff/create"),children:[e.jsx(v,{size:18,className:"mr-2"})," Add Staff"]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800 p-5 md:p-6 mb-8 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-5",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(_,{placeholder:"Search by name or email...",value:r,onChange:t=>m(t.target.value),icon:I,className:"h-11 md:h-12 rounded-xl font-bold"})}),e.jsx("div",{children:e.jsxs("select",{value:n,onChange:t=>k(t.target.value),className:"w-full h-11 md:h-12 rounded-xl border-slate-200 dark:border-slate-800 dark:bg-slate-800 focus:ring-indigo-500 font-bold text-xs px-4",children:[e.jsx("option",{value:"ALL",children:"All Staff Types"}),e.jsx("option",{value:"TEACHER",children:"Teaching Staff"}),e.jsx("option",{value:"DRIVER",children:"Drivers"}),e.jsx("option",{value:"ADMIN",children:"Administrative"}),e.jsx("option",{value:"SUPPORT",children:"Support Staff"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"MAINTENANCE",children:"Maintenance"}),e.jsx("option",{value:"KITCHEN",children:"Kitchen"}),e.jsx("option",{value:"LIBRARIAN",children:"Librarian"}),e.jsx("option",{value:"LAB_TECH",children:"Lab Technician"}),e.jsx("option",{value:"NURSE",children:"Nurse"}),e.jsx("option",{value:"CLEANER",children:"Cleaner"}),e.jsx("option",{value:"OTHER",children:"Other"})]})}),e.jsx("div",{children:e.jsxs("select",{value:u,onChange:t=>y(t.target.value),className:"w-full h-11 md:h-12 rounded-xl border-slate-200 dark:border-slate-800 dark:bg-slate-800 focus:ring-indigo-500 font-bold text-xs px-4",children:[e.jsx("option",{value:"ALL",children:"All Active Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"ON_LEAVE",children:"On Leave"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})})]})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8",children:[{label:"Total Staff",value:l.length,icon:R,color:"indigo"},{label:"Active",value:l.filter(t=>t.status==="ACTIVE").length,icon:f,color:"emerald"},{label:"On Leave",value:l.filter(t=>t.status==="ON_LEAVE").length,icon:w,color:"amber"},{label:"Inactive",value:l.filter(t=>t.status==="INACTIVE").length,icon:z,color:"rose"}].map((t,a)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800 p-5 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`p-2.5 rounded-xl bg-${t.color}-50 dark:bg-${t.color}-900/20 text-${t.color}-600 dark:text-${t.color}-400`,children:e.jsx(t.icon,{size:20})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:t.label}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:t.value})]})]},a))}),j.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(t=>e.jsx(B,{staff:t,onView:A,onEdit:S,onDelete:E},`${t.staff_type}-${t.id}`))}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-12 text-center",children:[e.jsx(f,{size:48,className:"mx-auto text-slate-300 dark:text-slate-700 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-2",children:"No staff members found"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:"Get started by adding your first staff member"}),e.jsxs(c,{onClick:()=>s("/hr/staff/create"),children:[e.jsx(v,{size:18,className:"mr-2"})," Add Staff Member"]})]})]})})};export{G as default};
