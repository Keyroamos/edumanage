import{k,u as w,r as i,e as o,j as e}from"./vendor-Cr6tcs86.js";import{B as y}from"./index-41VSs_U4.js";import{p as _,a3 as E,E as D,J as C,aA as A,F as V,X as L}from"./ui-BBn2VFCU.js";const P=()=>{const{id:d}=k(),c=w(),[s,h]=i.useState(null),[b,u]=i.useState(!0),[p,n]=i.useState(!1),[v,g]=i.useState([]),[a,l]=i.useState({first_name:"",last_name:"",phone_number:"",license_number:"",status:"",vehicle_id:""});i.useEffect(()=>{x()},[d]);const x=async()=>{try{const[t,m]=await Promise.all([o.get(`/api/transport/drivers/${d}/`),o.get("/api/transport/vehicles/")]);h(t.data),g(m.data.vehicles);const r=t.data;l({first_name:r.first_name,last_name:r.last_name,phone_number:r.phone,license_number:r.license,status:r.status,vehicle_id:r.vehicle?r.vehicle.id:""})}catch(t){console.error(t)}finally{u(!1)}},f=async t=>{t.preventDefault();try{await o.post(`/api/transport/drivers/${d}/`,{action:"UPDATE",...a}),n(!1),x()}catch{alert("Failed to update driver. specific vehicle might already be assigned.")}},j=async()=>{if(confirm("Are you sure you want to delete this driver?"))try{await o.post(`/api/transport/drivers/${d}/`,{action:"DELETE"}),c("/transport-portal/drivers")}catch{alert("Failed to delete driver")}};if(b)return e.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-600 border-t-transparent"})});if(!s)return e.jsx("div",{className:"p-8 text-center",children:"Driver not found"});const N=v.filter(t=>!t.driver_id||t.driver_id===s.id);return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 pb-12",children:[e.jsx("div",{className:"max-w-4xl mx-auto px-4 pt-6 mb-6",children:e.jsxs("button",{onClick:()=>c("/transport-portal/drivers"),className:"flex items-center gap-2 text-slate-500 hover:text-indigo-600 transition-colors mb-4 font-medium",children:[e.jsx(_,{size:18}),"Back to Drivers"]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-xl overflow-hidden border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-900 to-indigo-800 p-8 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full blur-3xl -mr-16 -mt-16"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-white/10 backdrop-blur-md rounded-full border-4 border-white/10 shadow-lg flex items-center justify-center text-3xl font-bold",children:s.first_name.charAt(0)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:[s.first_name," ",s.last_name]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold border ${s.status==="ACTIVE"?"bg-emerald-500/20 text-emerald-300 border-emerald-500/30":"bg-slate-500/20 text-slate-300 border-slate-500/30"}`,children:s.status})]}),e.jsxs("p",{className:"text-indigo-200 text-lg flex items-center gap-2",children:[e.jsx(E,{size:18}),s.phone]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-xl backdrop-blur-sm transition-colors text-sm font-bold flex items-center gap-2",children:[e.jsx(D,{size:16})," Edit Profile"]}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 hover:text-red-300 rounded-xl backdrop-blur-sm transition-colors text-sm font-bold flex items-center gap-2",children:e.jsx(C,{size:16})})]})]})]}),e.jsxs("div",{className:"p-8 grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-2xl p-6 border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(A,{className:"text-indigo-500"}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Assigned Vehicle"})]}),s.vehicle?e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1 font-mono",children:s.vehicle.plate}),e.jsx("p",{className:"text-slate-500 mb-3",children:s.vehicle.model}),e.jsx("button",{onClick:()=>c(`/transport-portal/vehicles/${s.vehicle.id}`),className:"text-sm text-indigo-600 hover:underline font-medium",children:"View Vehicle Details"})]}):e.jsxs("div",{className:"text-slate-500 flex flex-col items-start gap-2",children:[e.jsx("p",{children:"No vehicle currently assigned."}),e.jsx("button",{onClick:()=>n(!0),className:"text-sm text-indigo-600 font-bold",children:"Assign Vehicle"})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-2xl p-6 border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(V,{className:"text-indigo-500"}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"License Details"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase font-bold mb-1",children:"License Number"}),e.jsx("p",{className:"text-xl font-mono font-bold text-slate-900 dark:text-white select-all",children:s.license})]})]})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-lg shadow-2xl animate-scale-in",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Edit Driver"}),e.jsx("button",{onClick:()=>n(!1),children:e.jsx(L,{size:24,className:"text-slate-400"})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"First Name"}),e.jsx("input",{type:"text",value:a.first_name,onChange:t=>l({...a,first_name:t.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Last Name"}),e.jsx("input",{type:"text",value:a.last_name,onChange:t=>l({...a,last_name:t.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 dark:text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:a.phone_number,onChange:t=>l({...a,phone_number:t.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"License"}),e.jsx("input",{type:"text",value:a.license_number,onChange:t=>l({...a,license_number:t.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Status"}),e.jsxs("select",{value:a.status,onChange:t=>l({...a,status:t.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 dark:text-white",children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"ON_LEAVE",children:"On Leave"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Vehicle"}),e.jsxs("select",{value:a.vehicle_id,onChange:t=>l({...a,vehicle_id:t.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 dark:text-white",children:[e.jsx("option",{value:"",children:"-- Unassigned --"}),N.map(t=>e.jsxs("option",{value:t.id,children:[t.plate_number," (",t.model,")"]},t.id))]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(y,{type:"submit",className:"w-full bg-indigo-600 text-white py-3 rounded-xl font-bold",children:"Update Driver"})})]})]})})]})};export{P as default};
