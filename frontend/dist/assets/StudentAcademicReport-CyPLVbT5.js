import{k as O,u as E,r as h,j as e,m as D,e as N}from"./vendor-Cr6tcs86.js";import{u as I,B as b}from"./index-wvMzqk1Z.js";import{a7 as k,K as R,as as B,aj as F,v as T,a8 as G,a9 as L,B as J,af as M}from"./ui-BBn2VFCU.js";const H=()=>{const{id:d}=O(),i=E(),{config:v}=I(),[l,w]=h.useState(null),[c,y]=h.useState(null),[$,S]=h.useState(!0),[o,u]=h.useState("all"),p=()=>window.location.pathname.startsWith("/teacher/"),g=()=>{const s=JSON.parse(localStorage.getItem("user")||"{}");return s?.teacher?.pk||s?.id||""};if(h.useEffect(()=>{(async()=>{try{const[t,r]=await Promise.all([N.get(`/api/students/${d}/academics/`),N.get(`/api/students/${d}/`)]);w(t.data),y(r.data.student)}catch(t){console.error("Error fetching data:",t)}finally{S(!1)}})()},[d]),$)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-950",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-slate-200 border-t-primary-600"}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:"Loading Report..."})]})});if(!l||!c)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-50 dark:bg-slate-950 gap-4",children:[e.jsx(k,{size:48,className:"text-slate-300"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Report Not Found"}),e.jsx(b,{onClick:()=>{if(p()){const s=g();i(`/teacher/${s}/student/${d}`)}else i(`/students/${d}`)},children:"Back to Profile"})]});const _=s=>({4:"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-400 border-emerald-200 dark:border-emerald-800",3:"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400 border-blue-200 dark:border-blue-800",2:"bg-amber-50 text-amber-700 dark:bg-amber-900/20 dark:text-amber-400 border-amber-200 dark:border-amber-800",1:"bg-rose-50 text-rose-700 dark:bg-rose-900/20 dark:text-rose-400 border-rose-200 dark:border-rose-800"})[s]||"bg-slate-50 text-slate-700 border-slate-200",j=s=>({4:"bg-emerald-500",3:"bg-blue-500",2:"bg-amber-500",1:"bg-rose-500"})[s]||"bg-slate-400",z=o==="all"?l.records:{[o]:l.records[o]},x={};Object.values(l.records).forEach(s=>{Object.values(s).forEach(t=>{t.subjects.forEach(r=>{x[r.subject_name]||(x[r.subject_name]={total:0,count:0}),x[r.subject_name].total+=r.marks,x[r.subject_name].count+=1})})});const f=Object.entries(x).map(([s,t])=>({name:s,average:(t.total/t.count).toFixed(1)})).sort((s,t)=>t.average-s.average),P=Math.max(...f.map(s=>parseFloat(s.average)));return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-white/95 dark:bg-slate-900/95 backdrop-blur-lg border-b border-slate-200 dark:border-slate-800 shadow-sm",children:e.jsx("div",{className:"max-w-[1600px] mx-auto px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>{const s=JSON.parse(localStorage.getItem("user")||"{}");if(p()){const t=g();i(`/teacher/${t}/student/${d}`)}else s.role==="student"?i(`/student/${d}`):i(`/students/${d}`)},className:"group flex items-center gap-2 text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white transition-colors",children:[e.jsx(R,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:"Back to Profile"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{variant:"ghost",size:"sm",className:"text-xs",children:[e.jsx(B,{size:14,className:"mr-1.5"}),"Share"]}),e.jsxs(b,{variant:"ghost",size:"sm",className:"text-xs",children:[e.jsx(F,{size:14,className:"mr-1.5"}),"Print"]}),e.jsxs(b,{variant:"primary",size:"sm",className:"text-xs",children:[e.jsx(T,{size:14,className:"mr-1.5"}),"Export PDF"]})]})]})})}),e.jsxs("div",{className:"max-w-[1600px] mx-auto px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"h-10 w-10 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:e.jsx(k,{size:20,className:"text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[v.school_name," Academic Report"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:"Comprehensive Assessment Analysis"})]})]})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide",children:"Generated"}),e.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:new Date().toLocaleDateString()})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-6 pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"Student Name"}),e.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:c.personal.full_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"Admission No."}),e.jsx("p",{className:"text-sm font-mono font-semibold text-slate-900 dark:text-white",children:c.personal.admission_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"Grade/Class"}),e.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:c.personal.grade})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"Overall Average"}),e.jsxs("p",{className:"text-sm font-bold text-primary-600 dark:text-primary-400",children:[l.stats.average_score,"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Performance Distribution"}),e.jsx(G,{size:16,className:"text-slate-400"})]}),e.jsx("div",{className:"space-y-3",children:[{level:"4",label:"Exceeding",count:l.performance_distribution.exceeding,color:"emerald"},{level:"3",label:"Meeting",count:l.performance_distribution.meeting,color:"blue"},{level:"2",label:"Approaching",count:l.performance_distribution.approaching,color:"amber"},{level:"1",label:"Below",count:l.performance_distribution.below,color:"rose"}].map(s=>{const t=(s.count/(l.stats.total_assessments||1)*100).toFixed(0);return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:[s.label," (",s.level,")"]}),e.jsxs("span",{className:"font-bold text-slate-900 dark:text-white",children:[s.count," ",e.jsxs("span",{className:"text-slate-400",children:["(",t,"%)"]})]})]}),e.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-${s.color}-500 transition-all duration-500`,style:{width:`${t}%`}})})]},s.level)})})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Subject Performance Overview"}),e.jsx(L,{size:16,className:"text-slate-400"})]}),e.jsx("div",{className:"space-y-2.5",children:f.map((s,t)=>e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:s.name}),e.jsxs("span",{className:"font-bold text-slate-900 dark:text-white",children:[s.average,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary-500 to-primary-600 group-hover:from-primary-600 group-hover:to-primary-700 transition-all duration-300",style:{width:`${parseFloat(s.average)/P*100}%`}})})]},t))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[e.jsx("button",{onClick:()=>u("all"),className:`px-4 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${o==="all"?"bg-slate-900 dark:bg-primary-600 text-white shadow-sm":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700"}`,children:"All Terms"}),Object.keys(l.records).map(s=>e.jsx("button",{onClick:()=>u(s),className:`px-4 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap ${o===s?"bg-slate-900 dark:bg-primary-600 text-white shadow-sm":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700"}`,children:s},s))]}),Object.entries(z).map(([s,t])=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-0.5 w-8 bg-primary-500 rounded-full"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:s})]}),Object.entries(t).map(([r,m])=>{const C=(m.subjects.reduce((a,n)=>a+n.marks,0)/m.subjects.length).toFixed(1);return e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-primary-100 dark:bg-primary-900/30 rounded-lg flex items-center justify-center",children:e.jsx(J,{size:14,className:"text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 dark:text-white capitalize",children:[r.replace("-"," ")," Assessment"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:m.date})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Subjects"}),e.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:m.subjects.length})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Average"}),e.jsxs("p",{className:"text-sm font-bold text-primary-600 dark:text-primary-400",children:[C,"%"]})]}),JSON.parse(localStorage.getItem("user")||"{}").role!=="student"&&e.jsxs(b,{size:"sm",variant:"ghost",className:"text-xs",onClick:()=>{const a=c?.academic?.grade_id||c?.grade_id||"",n=s.replace("Term ","");if(p()){const A=g();i(`/teacher/${A}/academics?student=${d}&grade=${a}&term=${n}&type=${r}&edit=true`)}else i(`/academics?student=${d}&grade=${a}&term=${n}&type=${r}&edit=true`)},children:[e.jsx(M,{size:14,className:"mr-1.5"}),"Edit"]})]})]})}),e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800",children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Subject"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Score"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Performance"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:m.subjects.map((a,n)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900 dark:text-white",children:a.subject_name}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500 dark:text-slate-400 font-mono",children:a.subject_code}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"h-1.5 w-16 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${j(a.performance_level)}`,style:{width:`${a.marks}%`}})}),e.jsxs("span",{className:"text-sm font-bold text-slate-900 dark:text-white w-12 text-right",children:[a.marks,"%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-md text-xs font-semibold border ${_(a.performance_level)}`,children:a.performance_label})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:`inline-flex h-7 w-7 rounded-lg ${j(a.performance_level)} items-center justify-center text-white text-xs font-bold shadow-sm`,children:a.performance_level})})]},n))})]})})})]},r)})]},s))]})]})};export{H as default};
