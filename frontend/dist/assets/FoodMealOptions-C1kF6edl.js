import{r as t,e as c,j as e}from"./vendor-Cr6tcs86.js";import{B as x}from"./index-DR2ymqTX.js";import{$ as u,j as E,aB as S,E as _,J as D,w as L,X as M}from"./ui-BBn2VFCU.js";const T=()=>{const[g,h]=t.useState([]),[p,f]=t.useState(!0),[o,v]=t.useState(""),[j,r]=t.useState(!1),[n,b]=t.useState(!1),[a,l]=t.useState({id:null,name:"",cost:"",per_serving_cost:"",billing_cycle:"DAILY",description:""}),w=[{value:"DAILY",label:"Daily (Recurring)"},{value:"MONTHLY",label:"Monthly (Recurring)"},{value:"TERMLY",label:"Termly (Recurring)"},{value:"ONE_OFF",label:"One Off / Ad-hoc"}];t.useEffect(()=>{d()},[]);const d=async()=>{try{const s=await c.get("/api/food/items/");h(s.data.items||[])}catch(s){console.error(s)}finally{f(!1)}},k=async s=>{s.preventDefault();try{await c.post("/api/food/items/",{action:n?"UPDATE":"CREATE",...a}),r(!1),d(),i()}catch{alert("Failed to save item")}},N=async(s,m)=>{if(confirm(`Are you sure you want to delete "${m}"? This will hide it from new subscriptions.`))try{await c.post("/api/food/items/",{action:"DELETE",id:s}),d()}catch{alert("Failed to delete item")}},y=s=>{l({id:s.id,name:s.name,cost:s.cost,per_serving_cost:s.per_serving_cost||"",billing_cycle:s.cycle,description:s.description||""}),b(!0),r(!0)},i=()=>{l({id:null,name:"",cost:"",per_serving_cost:"",billing_cycle:"DAILY",description:""}),b(!1)},C=(g||[]).filter(s=>(s.name||"").toLowerCase().includes(o.toLowerCase())||(s.cycle||"").toLowerCase().includes(o.toLowerCase()));return p?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in-up pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-2",children:"Meal Options"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Manage available food items, prices, and billing cycles"})]}),e.jsxs(x,{onClick:()=>{i(),r(!0)},className:"bg-orange-600 hover:bg-orange-700 text-white shadow-lg shadow-orange-600/20",children:[e.jsx(u,{size:20,className:"mr-2"}),"Create New Item"]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search meal plans...",value:o,onChange:s=>v(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 dark:text-white"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[C.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm border border-slate-100 dark:border-slate-700 group hover:shadow-md transition-all relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-orange-50 dark:bg-orange-900/10 rounded-full blur-2xl -mr-10 -mt-10 pointer-events-none group-hover:bg-orange-100 dark:group-hover:bg-orange-900/20 transition-colors"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-xl",children:e.jsx(S,{size:24})}),e.jsxs("div",{className:"flex gap-2 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>y(s),className:"p-2 bg-white dark:bg-slate-700 text-slate-500 hover:text-blue-600 rounded-lg shadow-sm border border-slate-200 dark:border-slate-600 transition-colors",children:e.jsx(_,{size:16})}),e.jsx("button",{onClick:()=>N(s.id,s.name),className:"p-2 bg-white dark:bg-slate-700 text-slate-500 hover:text-red-600 rounded-lg shadow-sm border border-slate-200 dark:border-slate-600 transition-colors",children:e.jsx(D,{size:16})})]})]}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 line-clamp-2 h-10 mb-4",children:s.description||"No description provided."}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"px-2.5 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold uppercase tracking-wide",children:(s.cycle||"").replace("_"," ")}),s.active_subscribers>0&&e.jsxs("span",{className:"px-2.5 py-1 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx(L,{size:12})," ",s.active_subscribers," Active"]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100 dark:border-slate-700",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Cost Per Unit"}),e.jsxs("p",{className:"text-2xl font-black text-slate-800 dark:text-white font-mono",children:["KES ",(s.cost||0).toLocaleString()]})]})]})]},s.id)),e.jsxs("button",{onClick:()=>{i(),r(!0)},className:"border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl p-6 flex flex-col items-center justify-center text-slate-400 hover:border-orange-400 hover:text-orange-500 hover:bg-orange-50 dark:hover:bg-slate-800/50 transition-all group min-h-[280px]",children:[e.jsx("div",{className:"mb-4 p-4 bg-slate-50 dark:bg-slate-800 rounded-full group-hover:scale-110 transition-transform",children:e.jsx(u,{size:32})}),e.jsx("span",{className:"font-bold text-lg",children:"Add New Item"})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl w-full max-w-lg shadow-2xl animate-scale-in overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-900 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:n?"Edit Meal Option":"New Meal Option"}),e.jsx("button",{onClick:()=>r(!1),className:"text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(M,{size:24})})]}),e.jsx("div",{className:"p-6 md:p-8",children:e.jsxs("form",{onSubmit:k,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Item Name"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>l({...a,name:s.target.value}),required:!0,placeholder:"e.g. Special Diet Lunch",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-orange-500 outline-none dark:text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Cost (KES)"}),e.jsx("input",{type:"number",value:a.cost,onChange:s=>l({...a,cost:s.target.value}),required:!0,placeholder:"0.00",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-orange-500 outline-none dark:text-white font-mono font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Billing Cycle"}),e.jsx("select",{value:a.billing_cycle,onChange:s=>l({...a,billing_cycle:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-orange-500 outline-none dark:text-white",children:w.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:s=>l({...a,description:s.target.value}),rows:"3",placeholder:"Describe what this meal option includes...",className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 focus:ring-2 focus:ring-orange-500 outline-none dark:text-white resize-none"})]}),e.jsxs("div",{className:"pt-2 flex gap-3",children:[e.jsx(x,{type:"button",variant:"outline",className:"flex-1",onClick:()=>r(!1),children:"Cancel"}),e.jsx(x,{type:"submit",className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white shadow-lg shadow-orange-600/20",children:n?"Update Item":"Create Item"})]})]})})]})})]})};export{T as default};
