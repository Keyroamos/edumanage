import{r as i,d as te,e as j,j as e,A as W,m as y,u as ge}from"./vendor-Cr6tcs86.js";import fe from"./Salaries-DE2x9DgF.js";import je from"./TransportFinance-7o_wzUIt.js";import ye from"./FoodFinance-BcxIswpA.js";import{u as ae,B as w}from"./index-DR2ymqTX.js";import{ae as Y,j as le,w as re,h as ve,O as Ne,X as H,af as ke,D as U,J as we,B as Ce,$ as V,ag as Se,W as Q,U as Fe,F as _e,s as ie,t as q,Y as Te,C as Ee,a9 as $e,ah as ze,v as Ae,ai as Le}from"./ui-BBn2VFCU.js";import{R as Z,A as Re,C as De,X as Oe,Y as Be,T as ee,a as se,P as Ge,b as Me,c as Ie}from"./charts-Fmv3L88u.js";const Pe=()=>{const{config:l}=ae(),[n,E]=i.useState([]),[$,v]=i.useState([]),[d,z]=i.useState([]),[p,D]=i.useState(!0),[N,C]=i.useState(!1),[c,O]=i.useState(""),[S,A]=i.useState(null),[F,b]=i.useState(!1),[u,t]=i.useState(null),[o,L]=i.useState({}),[_,de]=i.useState("2024-2025"),[I,ne]=i.useState([]),[x,T]=i.useState({grade_id:"",term:"1",category_id:"",amount:"",is_mandatory:!0}),[oe,ce]=i.useState(null),[K,B]=i.useState({}),R=te.useMemo(()=>{const s={};return I.forEach(a=>{s[a]={1:[],2:[],3:[]}}),n.forEach(a=>{const r=a.grade;s[r]||(s[r]={1:[],2:[],3:[]}),s[r][a.term].push(a)}),s},[n,I]);i.useEffect(()=>{G()},[_]);const G=async()=>{D(!0);try{const[s,a,r]=await Promise.all([j.get(`/api/finance/fee-structures/?year=${_}`),j.get("/api/finance/fee-categories/"),j.get("/api/grades/")]),h=s.data.fee_structures||[];E(h);const m=r.data.grades||[];z(m),ne(m.map(P=>P.code));const g=a.data.categories||[];v(g);const J=g.find(P=>P.name.toLowerCase().includes("tuition"));J&&ce(J.id)}catch(s){console.error("Error fetching data:",s),k("error","Failed to load fee structures")}finally{D(!1)}},xe=async s=>{s&&s.preventDefault(),C(!0);try{await j.post("/api/finance/fee-structures/create/",{...x,academic_year:_}),k("success","Fee item added successfully"),b(!1),T({grade_id:"",term:"1",category_id:"",amount:"",is_mandatory:!0}),await G()}catch(a){console.error("Failed to add fee",a),k("error",a.response?.data?.error||"Failed to add fee item")}finally{C(!1)}},k=(s,a)=>{A({type:s,text:a}),setTimeout(()=>A(null),4e3)},me=(s,a)=>{t(s);const r={};Object.values(a).flat().forEach(h=>{r[h.id]=h.amount}),L(r),B({})},ue=()=>{t(null),L({}),B({})},he=(s,a)=>{L(r=>({...r,[s]:a}))},pe=async s=>{C(!0);try{const a=Object.entries(o).map(([m,g])=>({id:parseInt(m),amount:parseFloat(g)}));a.length>0&&await j.post("/api/finance/fee-structures/update/",{updates:a});const r=d.find(m=>m.code===s),h=Object.entries(K).filter(([m,g])=>g&&parseFloat(g)>0).map(([m,g])=>({grade_id:r.id,term:m,category_id:oe,amount:parseFloat(g),is_mandatory:!0,academic_year:_}));for(const m of h)await j.post("/api/finance/fee-structures/create/",m);k("success",`Updated ${s} fees successfully`),await G(),t(null),B({})}catch(a){console.error("Failed to update fees",a),k("error","Failed to update fees")}finally{C(!1)}},be=async s=>{if(confirm("Are you sure you want to delete this fee item?"))try{await j.delete(`/api/finance/fee-structures/${s}/`),k("success","Fee item deleted successfully"),await G()}catch{k("error","Failed to delete fee item")}},X=I.filter(s=>s.toLowerCase().includes(c.toLowerCase()));return p?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{className:"w-12 h-12 animate-spin text-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading fee structures..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Fee Structure Management"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Configure school fees by class, term, and category"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search class...",value:c,onChange:s=>O(s.target.value),className:"pl-10 pr-4 py-2 w-full sm:w-64 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-sm outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("select",{value:_,onChange:s=>de(s.target.value),className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"2024-2025",children:"2024-2025"}),e.jsx("option",{value:"2025-2026",children:"2025-2026"}),e.jsx("option",{value:"2026-2027",children:"2026-2027"})]})]})]}),e.jsx(W,{children:S&&e.jsxs(y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center gap-3 ${S.type==="success"?"bg-emerald-50 text-emerald-700 border border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-400":"bg-red-50 text-red-700 border border-red-200 dark:bg-red-900/20 dark:text-red-400"}`,children:[S.type==="success"?e.jsx(re,{size:20}):e.jsx(ve,{size:20}),e.jsx("span",{className:"font-medium",children:S.text})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:X.map(s=>e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-900 rounded-xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-slate-900 dark:text-white tracking-tight",children:s}),e.jsxs("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mt-1",children:["Academic Year ",_]})]}),u===s?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>pe(s),disabled:N,className:"p-2 rounded-lg bg-emerald-500 hover:bg-emerald-600 text-white shadow transition-colors disabled:opacity-50",children:N?e.jsx(Y,{size:16,className:"animate-spin"}):e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:ue,className:"p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(H,{size:16})})]}):e.jsx("button",{onClick:()=>me(s,R[s]),className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-800 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:e.jsx(ke,{size:16})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[1,2,3].map(a=>e.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-800/30 rounded-lg p-3 border border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest",children:["Term ",a]}),e.jsx(U,{size:12,className:"text-slate-400"})]}),e.jsx("div",{className:"space-y-3 min-h-[60px]",children:R[s][a]&&R[s][a].length>0||u===s?e.jsxs(e.Fragment,{children:[R[s][a].map(r=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase leading-none",children:r.category}),u===s?e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-slate-400",children:l.currency}),e.jsx("input",{type:"number",value:o[r.id]||0,onChange:h=>he(r.id,h.target.value),className:"w-full pl-8 pr-2 py-1.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-xs font-bold outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-all shadow-sm"})]}):e.jsxs("div",{className:"flex items-center justify-between group/fee",children:[e.jsxs("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:[l.currency," ",r.amount.toLocaleString()]}),e.jsx("button",{onClick:()=>be(r.id),className:"opacity-0 group-hover/fee:opacity-100 p-1 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-500/10 rounded transition-all",children:e.jsx(we,{size:12})})]})]},r.id)),u===s&&!R[s][a].some(r=>r.category.toLowerCase().includes("tuition"))&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-indigo-400 uppercase leading-none",children:"Tuition (New)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-slate-400",children:l.currency}),e.jsx("input",{type:"number",placeholder:"0.00",value:K[a]||"",onChange:r=>B(h=>({...h,[a]:r.target.value})),className:"w-full pl-8 pr-2 py-1.5 bg-indigo-50/50 dark:bg-indigo-500/5 border border-indigo-200 dark:border-indigo-500/20 rounded text-xs font-bold outline-none focus:ring-1 focus:ring-indigo-500 transition-all"})]})]})]}):e.jsx("span",{className:"text-[10px] italic text-slate-400",children:"No fees configured"})})]},a))})]},s))}),X.length===0&&e.jsxs("div",{className:"text-center py-16 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx(Ce,{className:"w-16 h-16 text-slate-300 dark:text-slate-700 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:c?"No classes found matching your search":"No fee structures configured yet"}),e.jsxs(w,{onClick:()=>b(!0),className:"mt-4 bg-indigo-600 hover:bg-indigo-700 text-white border-none",children:[e.jsx(V,{size:18,className:"mr-2"}),"Add First Fee Structure"]})]}),e.jsx(W,{children:F&&e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(!1),className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm"}),e.jsxs(y.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Add Fee Item"}),e.jsx("p",{className:"text-xs font-medium text-slate-500 mt-1",children:"Assign a fee category to a class and term"})]}),e.jsx("button",{onClick:()=>b(!1),className:"p-2 rounded-xl text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all font-bold",children:e.jsx(H,{size:20})})]}),e.jsxs("form",{onSubmit:xe,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Select Class"}),e.jsxs("select",{required:!0,value:x.grade_id,onChange:s=>T({...x,grade_id:s.target.value}),className:"w-full p-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all",children:[e.jsx("option",{value:"",children:"Choose Grade..."}),d.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Term"}),e.jsxs("select",{required:!0,value:x.term,onChange:s=>T({...x,term:s.target.value}),className:"w-full p-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all",children:[e.jsx("option",{value:"1",children:"Term 1"}),e.jsx("option",{value:"2",children:"Term 2"}),e.jsx("option",{value:"3",children:"Term 3"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Fee Category"}),e.jsxs("select",{required:!0,value:x.category_id,onChange:s=>T({...x,category_id:s.target.value}),className:"w-full p-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all",children:[e.jsx("option",{value:"",children:"Choose Category..."}),$.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:["Amount (",l.currency,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-sm",children:l.currency}),e.jsx("input",{required:!0,type:"number",placeholder:"0.00",value:x.amount,onChange:s=>T({...x,amount:s.target.value}),className:"w-full pl-12 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-bold outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("input",{type:"checkbox",id:"is_mandatory",checked:x.is_mandatory,onChange:s=>T({...x,is_mandatory:s.target.checked}),className:"w-5 h-5 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_mandatory",className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Mandatory fee (Automatically billed to students)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>b(!1),className:"flex-1 h-12 rounded-xl text-sm font-bold border-slate-200",children:"Cancel"}),e.jsx(w,{type:"submit",disabled:N,className:"flex-1 h-12 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl text-sm font-bold shadow-lg shadow-indigo-600/20 border-none",children:N?e.jsx(Y,{size:18,className:"animate-spin"}):"Save Fee Item"})]})]})]})]})})]})},M=["#6366f1","#10b981","#f59e0b","#ef4444","#8b5cf6"],f=({title:l,value:n,subtext:E,icon:$,color:v,trend:d,delay:z,net:p})=>e.jsx(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:z,duration:.4},className:"bg-white dark:bg-slate-900 p-5 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:items-start sm:justify-between sm:text-left gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center sm:items-start gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center sm:flex-row gap-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${v} bg-opacity-10 dark:bg-opacity-20`,children:e.jsx($,{size:18,className:`${v.replace("bg-","text-")} dark:text-opacity-90`})}),e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:l})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-2xl font-semibold tracking-tight ${p?n.includes("-")?"text-rose-600":"text-emerald-600":"text-slate-900 dark:text-white"}`,children:n}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1 font-medium",children:E})]})]}),d!==void 0&&e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-md text-[11px] font-semibold ${d>=0?"text-emerald-600 bg-emerald-50 dark:bg-emerald-500/10":"text-rose-600 bg-rose-50 dark:bg-rose-500/10"}`,children:[d>=0?e.jsx(ie,{size:12}):e.jsx(q,{size:12}),e.jsxs("span",{children:[Math.abs(d),"%"]})]})]})}),Je=()=>{const{config:l}=ae();ge();const[n,E]=i.useState(null),[$,v]=i.useState(!0),[d,z]=i.useState("overview"),[p,D]=i.useState(""),N=te.useMemo(()=>!n||!n.recent_collections?[]:n.recent_collections.filter(t=>t.student.toLowerCase().includes(p.toLowerCase())||t.reference.toLowerCase().includes(p.toLowerCase())||t.admission_no.toLowerCase().includes(p.toLowerCase())),[n,p]);i.useEffect(()=>{C()},[]);const C=async()=>{v(!0);try{const t=await j.get("/api/finance/");E(t.data)}catch(t){console.error("Error fetching finance:",t)}finally{v(!1)}};if($)return e.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-50 dark:bg-slate-950",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-24 w-24 rounded-full border-4 border-slate-200 dark:border-slate-800 border-t-indigo-600 animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center font-black text-[10px] tracking-widest text-indigo-600 animate-pulse",children:"SYNCING"})]})});if(!n)return null;const c=n.summary||{},O=n.chart_data||[];n.recent_collections;const S=n.recent_expenses||[],A=c.total_expenses||0,F=c.expense_breakdown||{},b=[{name:"Salaries",value:F.salaries||0},{name:"Transport",value:F.transport||0},{name:"Food",value:F.food||0},{name:"Other",value:F.other||0}].filter(t=>t.value>0),u=({id:t,label:o,icon:L})=>e.jsxs("button",{onClick:()=>z(t),className:`flex items-center gap-2 px-4 py-2 text-sm font-semibold transition-all rounded-lg whitespace-nowrap ${d===t?"text-indigo-600 bg-indigo-50 dark:text-indigo-400 dark:bg-indigo-900/30":"text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[e.jsx(L,{size:16}),o]});return e.jsxs("div",{className:"p-4 md:p-8 max-w-[1400px] mx-auto space-y-6 min-h-screen bg-slate-50/50 dark:bg-slate-950/20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 pb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white tracking-tight",children:"Finance Management"}),e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Manage fees, payroll, and school expenditures"})]}),e.jsxs("div",{className:"flex bg-white dark:bg-slate-900 p-1 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-x-auto no-scrollbar gap-1",children:[e.jsx(u,{id:"overview",label:"Overview",icon:Se}),e.jsx(u,{id:"collections",label:"Collections",icon:Q}),e.jsx(u,{id:"fee-structure",label:"Fee Structure",icon:U}),l.subscription?.plan!=="Basic"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{id:"payroll",label:"Payroll",icon:Fe}),e.jsx(u,{id:"expenses",label:"Expenses",icon:_e})]})]})]}),e.jsxs(W,{mode:"wait",children:[d==="overview"&&e.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"space-y-6",children:[e.jsxs("div",{className:`grid grid-cols-2 ${l.subscription?.plan==="Basic"?"lg:grid-cols-2":"lg:grid-cols-4"} gap-4`,children:[e.jsx(f,{title:"Net Balance",value:`${l.currency} ${((c.net_profit||0)/1e3).toFixed(1)}k`,subtext:"Income - Expenses",icon:U,color:"bg-indigo-600",net:!0,delay:0}),e.jsx(f,{title:"Total Income",value:`${l.currency} ${((c.total_revenue||0)/1e3).toFixed(1)}k`,subtext:"Fees & others",icon:ie,color:"bg-emerald-600",trend:12,delay:.1}),l.subscription?.plan!=="Basic"&&e.jsxs(e.Fragment,{children:[e.jsx(f,{title:"Total Expenses",value:`${l.currency} ${(A/1e3).toFixed(1)}k`,subtext:"Salaries & Ops",icon:q,color:"bg-rose-600",delay:.2}),e.jsx(f,{title:"Runway",value:`${c.runway||0} Mo`,subtext:"Burn rate based",icon:Te,color:"bg-amber-600",delay:.3})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Cash Flow"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Revenue vs Expenditure"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-4 text-[11px] font-semibold text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),"Income"]}),l.subscription?.plan!=="Basic"&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-rose-500"}),"Expenses"]})]}),e.jsxs("select",{className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-semibold text-slate-600 dark:text-slate-300 p-2 outline-none",children:[e.jsx("option",{children:"This Year"}),e.jsx("option",{children:"Last Year"})]})]})]}),e.jsx("div",{className:"h-[350px] w-full",children:O.length>0?e.jsx(Z,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(Re,{data:O,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorIncome",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#4f46e5",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#4f46e5",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorExpense",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f43f5e",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#f43f5e",stopOpacity:0})]})]}),e.jsx(De,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(Oe,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#94a3b8",fontSize:10,fontWeight:600},dy:10}),e.jsx(Be,{axisLine:!1,tickLine:!1,tick:{fill:"#94a3b8",fontSize:10,fontWeight:600},tickFormatter:t=>`${t/1e3}k`}),e.jsx(ee,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),e.jsx(se,{type:"monotone",dataKey:"revenue",stroke:"#4f46e5",strokeWidth:3,fill:"url(#colorIncome)"}),l.subscription?.plan!=="Basic"&&e.jsx(se,{type:"monotone",dataKey:"expenses",stroke:"#f43f5e",strokeWidth:3,fill:"url(#colorExpense)"})]})}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-400 font-medium text-sm",children:"No data available"})})]}),l.subscription?.plan!=="Basic"&&e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:"Expenses"}),e.jsx("p",{className:"text-xs font-medium text-slate-500 mb-6",children:"By Category"}),e.jsxs("div",{className:"h-64 relative w-full mb-6",children:[e.jsx(Z,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(Ge,{children:[e.jsx(Me,{data:b,innerRadius:60,outerRadius:80,paddingAngle:4,dataKey:"value",cornerRadius:4,children:b.map((t,o)=>e.jsx(Ie,{fill:M[o%M.length]},`cell-${o}`))}),e.jsx(ee,{})]})}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col pointer-events-none",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Total"}),e.jsxs("span",{className:"text-xl font-bold text-slate-900 dark:text-white",children:[(A/1e3).toFixed(0),"k"]})]})]}),e.jsx("div",{className:"space-y-3",children:(b||[]).map((t,o)=>e.jsxs("div",{className:"flex justify-between items-center text-xs font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:M[o%M.length]}}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:t.name})]}),e.jsxs("span",{className:"text-slate-900 dark:text-white uppercase",children:[l.currency," ",t.value.toLocaleString()]})]},o))})]})]})]},"overview"),d==="collections"&&e.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(f,{title:"Total Collected",value:`${l.currency} ${((c.total_revenue||0)/1e3).toFixed(1)}k`,subtext:"Total revenue",icon:Q,color:"bg-emerald-600"}),e.jsx(f,{title:"Expected Fees",value:`${l.currency} ${((c.expected_fees||0)/1e3).toFixed(1)}k`,subtext:"Total billings",icon:Ee,color:"bg-blue-600"}),e.jsx(f,{title:"Outstanding",value:`${l.currency} ${((c.fees_arrears||0)/1e3).toFixed(1)}k`,subtext:"Unpaid total",icon:q,color:"bg-red-600"}),e.jsx(f,{title:"Collection Rate",value:`${c.collection_rate||0}%`,subtext:"Target: 85%",icon:$e,color:"bg-violet-600"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col xl:flex-row xl:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white tracking-tight",children:"Recent Collections"}),e.jsx("p",{className:"text-xs font-medium text-slate-500 mt-1",children:"Real-time ledger of incoming fee payments"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{placeholder:"Search by student, admission or ref...",className:"pl-9 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm font-medium text-slate-600 dark:text-slate-300 outline-none w-full sm:w-64 focus:ring-2 focus:ring-indigo-500/20 transition-all",value:p,onChange:t=>D(t.target.value)})]}),e.jsxs(w,{variant:"outline",className:"h-9 px-3 text-xs font-semibold",children:[e.jsx(ze,{size:14,className:"mr-2"})," Filter"]}),e.jsxs(w,{variant:"primary",className:"h-9 px-4 text-xs font-semibold bg-indigo-600 border-none shadow-sm",children:[e.jsx(V,{size:14,className:"mr-2"})," Record Payment"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800",children:e.jsxs("tr",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Student"}),e.jsx("th",{className:"px-6 py-4",children:"Reference"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4",children:"Channel"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:(N||[]).length>0?N.map((t,o)=>e.jsxs("tr",{className:"group hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-indigo-600 font-bold text-xs ring-1 ring-slate-200 dark:ring-slate-700",children:t.student[0]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:t.student}),e.jsxs("p",{className:"text-[10px] font-medium text-slate-500",children:["ADM: ",t.admission_no]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-xs font-mono font-medium text-slate-500 bg-slate-50/50 dark:bg-slate-800/50 px-2 py-1 rounded-md border border-slate-100 dark:border-slate-800",children:t.reference})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-bold text-emerald-600",children:[l.currency," ",t.amount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider ${t.method==="MPESA"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-blue-50 text-blue-600 border border-blue-100"}`,children:t.method})}),e.jsx("td",{className:"px-6 py-4 text-xs font-medium text-slate-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100",children:[e.jsx(re,{size:10})," Verified"]})})]},o)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-8 py-16 text-center text-slate-400 font-medium",children:"No results found"})})})]})})]})]},"collections"),d==="expenses"&&e.jsx(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white tracking-tight",children:"Expenditure Ledger"}),e.jsx("p",{className:"text-xs font-medium text-slate-500",children:"Detailed record of school outflows"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(w,{variant:"primary",className:"h-9 px-4 text-xs font-semibold bg-rose-600 border-none shadow-sm",children:[e.jsx(V,{size:14,className:"mr-2"})," Record Expense"]}),e.jsxs(w,{variant:"outline",className:"h-9 px-3 text-xs font-semibold",children:[e.jsx(Ae,{size:14,className:"mr-2"})," Export"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800",children:e.jsxs("tr",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Title"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4",children:"Payee"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:(S||[]).map((t,o)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-sm text-slate-900 dark:text-white",children:t.title}),e.jsx("td",{className:"px-6 py-4 text-[10px] font-bold uppercase tracking-wider text-slate-500",children:t.category}),e.jsxs("td",{className:"px-6 py-4 text-sm font-bold text-rose-600",children:[l.currency," ",t.amount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-xs font-medium text-slate-500",children:t.vendor||"Staff"}),e.jsx("td",{className:"px-6 py-4 text-xs font-medium text-slate-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{className:"p-1.5 rounded bg-slate-100 dark:bg-slate-800 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(Le,{size:14})})})]},o))})]})})]})},"expenses"),d==="fee-structure"&&e.jsx(Pe,{}),d==="payroll"&&e.jsx(fe,{}),d==="transport"&&e.jsx(je,{}),d==="food"&&e.jsx(ye,{})]})]})};export{Je as default};
