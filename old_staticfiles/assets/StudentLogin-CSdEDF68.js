import{u as v,r as l,d as w,j as e,e as h}from"./vendor-Cr6tcs86.js";import{u as k,I as f,B as y}from"./index-eBdLMQe5.js";import{G as C,i as I,n as _,h as E}from"./ui-kKL2mqtN.js";const F=()=>{const p=v(),{config:n}=k(),[a,b]=l.useState({username:"",password:""}),[c,o]=l.useState(""),[m,u]=l.useState(!1),[j,d]=l.useState(null),[N,x]=l.useState(!0),i=new URLSearchParams(window.location.search),s=i.get("slug")||localStorage.getItem("portal_slug");i.get("slug")&&localStorage.setItem("portal_slug",i.get("slug")),w.useEffect(()=>{(async()=>{if(s)try{const t=await h.get("/api/config/",{headers:{"X-Portal-Slug":s}});d(t.data)}catch(t){console.error("Failed to fetch school config:",t),d(n)}finally{x(!1)}else d(n),x(!1)})()},[s,n]);const g=r=>{b({...a,[r.target.name]:r.target.value}),o("")},S=async r=>{r.preventDefault(),o(""),u(!0);try{const t=await h.post("/api/login/",{username:a.username,password:a.password,portal_slug:s});t.data.success&&(localStorage.setItem("user",JSON.stringify(t.data.user)),t.data.portal_slug&&localStorage.setItem("portal_slug",t.data.portal_slug),t.data.user.role==="student"&&t.data.user.student_id?p(`/student/${t.data.user.student_id}`):o("This portal is for students only"))}catch(t){o(t.response?.data?.error||"Invalid credentials")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl shadow-lg shadow-green-500/30 mb-4",children:e.jsx(C,{size:40,className:"text-white"})}),N?e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded w-3/4 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/2 mx-auto"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-2",children:[j?.school_name||"School"," Student Portal"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Access your academic information"}),s&&e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-500 mt-2 font-mono bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded inline-block",children:["Portal: ",s]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-700 p-8",children:[c&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl flex items-start gap-3",children:[e.jsx(I,{size:20,className:"text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:c})]}),e.jsxs("form",{onSubmit:S,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e.jsx(_,{size:16,className:"inline mr-2"}),"Student ID / Admission Number"]}),e.jsx(f,{type:"text",name:"username",value:a.username,onChange:g,placeholder:"Enter your student ID",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e.jsx(E,{size:16,className:"inline mr-2"}),"Password"]}),e.jsx(f,{type:"password",name:"password",value:a.password,onChange:g,placeholder:"Enter your password",required:!0})]}),e.jsx(y,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",isLoading:m,children:m?"Signing in...":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:"#",className:"text-sm text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300",children:"Forgot your password?"})})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-slate-500 dark:text-slate-400",children:e.jsx("p",{children:"Need help? Contact your school administrator"})})]})})};export{F as default};
