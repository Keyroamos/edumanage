import{k as P,u as O,r as d,e as g,j as e,m as f}from"./vendor-Cr6tcs86.js";import{B as b,I as i}from"./index-eBdLMQe5.js";import{X as U,i as D,n as $,ab as z,g as N,a4 as B,a3 as S,V as F,N as H,O as V,P as q}from"./ui-kKL2mqtN.js";const X=()=>{const{id:r}=P(),o=O(),[n,c]=d.useState(1),[m,u]=d.useState(!0),[x,j]=d.useState(!1),[C,k]=d.useState([]),[y,h]=d.useState(null),[s,_]=d.useState({first_name:"",last_name:"",email:"",phone:"",national_id:"",staff_type:"SUPPORT",position:"Staff",date_of_birth:"",address:"",basic_salary:0,status:"ACTIVE",gender:"M",religion:"CHRISTIAN",marital_status:"SINGLE",nationality:"Kenyan",job_description:"",supervisor_id:"",emergency_contact_name:"",emergency_contact_phone:""});d.useEffect(()=>{E(),I()},[r]);const E=async()=>{try{const a=(await g.get(`/api/hr/staff/${r}/`)).data.staff;_({first_name:a.personal.first_name,last_name:a.personal.last_name,email:a.personal.email,phone:a.personal.phone,national_id:a.personal.national_id,date_of_birth:a.personal.date_of_birth,address:a.personal.address,gender:a.personal.gender,religion:a.personal.religion,marital_status:a.personal.marital_status,nationality:a.personal.nationality,staff_type:a.professional.staff_type,position:a.professional.position,status:a.professional.status,job_description:a.professional.job_description,supervisor_id:a.professional.supervisor_id||"",basic_salary:a.financial.basic_salary,emergency_contact_name:a.emergency.contact_name,emergency_contact_phone:a.emergency.contact_phone})}catch(t){h("Failed to load staff data"),console.error(t)}finally{u(!1)}},I=async()=>{try{const t=await g.get("/api/hr/staff/");k(t.data.staff.filter(a=>a.id!==parseInt(r)))}catch(t){console.error("Error fetching staff for supervisors:",t)}},l=t=>{const{name:a,value:L}=t.target;_(M=>({...M,[a]:L}))},A=async t=>{t.preventDefault(),j(!0),h(null);try{(await g.put(`/api/hr/staff/${r}/update/`,s)).data.success&&o(`/hr/staff/${r}`)}catch(a){h(a.response?.data?.error||"Failed to update staff member")}finally{j(!1)}},w=()=>c(t=>t+1),T=()=>c(t=>t-1);if(m)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const R=[{value:"ADMIN",label:"Administrative"},{value:"SUPPORT",label:"Support Staff"},{value:"SECURITY",label:"Security"},{value:"MAINTENANCE",label:"Maintenance"},{value:"KITCHEN",label:"Kitchen"},{value:"LIBRARIAN",label:"Librarian"},{value:"LAB_TECH",label:"Lab Technician"},{value:"NURSE",label:"Nurse"},{value:"CLEANER",label:"Cleaner"},{value:"OTHER",label:"Other"}];return e.jsx("div",{className:"p-6 md:p-8 bg-slate-50 dark:bg-slate-950 min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Edit Staff Profile"}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400",children:["Update information for ",s.first_name," ",s.last_name]})]}),e.jsxs(b,{variant:"ghost",onClick:()=>o(`/hr/staff/${r}`),children:[e.jsx(U,{size:20,className:"mr-2"})," Cancel"]})]}),y&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-600 dark:text-red-400 flex items-center gap-3",children:[e.jsx(D,{size:20}),e.jsx("p",{className:"text-sm font-medium",children:y})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-slate-200 dark:border-slate-800",children:[e.jsx(v,{step:1,currentStep:n,label:"Personal Info",icon:$}),e.jsx(v,{step:2,currentStep:n,label:"Job & Financial",icon:z}),e.jsx(v,{step:3,currentStep:n,label:"Additional Details",icon:N})]}),e.jsxs("form",{onSubmit:A,className:"p-8",children:[n===1&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{label:"First Name",name:"first_name",value:s.first_name,onChange:l,required:!0}),e.jsx(i,{label:"Last Name",name:"last_name",value:s.last_name,onChange:l,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{type:"email",label:"Email Address",name:"email",value:s.email,onChange:l,required:!0,icon:B}),e.jsx(i,{label:"Phone Number",name:"phone",value:s.phone,onChange:l,required:!0,icon:S})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(p,{label:"Gender",name:"gender",value:s.gender,onChange:l,options:[{value:"M",label:"Male"},{value:"F",label:"Female"},{value:"O",label:"Other"}]}),e.jsx(p,{label:"Marital Status",name:"marital_status",value:s.marital_status,onChange:l,options:[{value:"SINGLE",label:"Single"},{value:"MARRIED",label:"Married"}]}),e.jsx(i,{label:"Nationality",name:"nationality",value:s.nationality,onChange:l})]}),e.jsx(i,{label:"Current Address",name:"address",value:s.address,onChange:l,icon:F})]}),n===2&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(p,{label:"Staff Type",name:"staff_type",value:s.staff_type,onChange:l,options:R}),e.jsx(i,{label:"Job Title / Position",name:"position",value:s.position,onChange:l})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(p,{label:"Supervisor",name:"supervisor_id",value:s.supervisor_id,onChange:l,options:[{value:"",label:"No Supervisor"},...C.map(t=>({value:t.id,label:`${t.first_name} ${t.last_name} (${t.position})`}))]}),e.jsx(p,{label:"Employment Status",name:"status",value:s.status,onChange:l,options:[{value:"ACTIVE",label:"Active"},{value:"INACTIVE",label:"Inactive"},{value:"ON_LEAVE",label:"On Leave"}]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsx(i,{type:"number",label:"Basic Salary (KES)",name:"basic_salary",value:s.basic_salary,onChange:l})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 ml-1",children:"Job Description"}),e.jsx("textarea",{name:"job_description",value:s.job_description,onChange:l,rows:4,className:"w-full rounded-xl border border-slate-200 bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white px-4 py-3 focus:ring-2 focus:ring-primary-100 focus:border-primary-500 transition-all outline-none"})]})]}),n===3&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(N,{className:"text-red-500",size:20})," Emergency Contact"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{label:"Contact Name",name:"emergency_contact_name",value:s.emergency_contact_name,onChange:l}),e.jsx(i,{label:"Contact Phone",name:"emergency_contact_phone",value:s.emergency_contact_phone,onChange:l,icon:S})]})]}),e.jsx("div",{className:"pt-6 border-t border-slate-200 dark:border-slate-800",children:e.jsx(p,{label:"Religion",name:"religion",value:s.religion,onChange:l,options:[{value:"CHRISTIAN",label:"Christian"},{value:"MUSLIM",label:"Muslim"},{value:"OTHER",label:"Other"}]})})]}),e.jsxs("div",{className:"flex justify-between mt-12 pt-8 border-t border-slate-200 dark:border-slate-800",children:[n>1?e.jsxs(b,{type:"button",variant:"outline",onClick:T,children:[e.jsx(H,{size:20,className:"mr-2"})," Back"]}):e.jsx("div",{}),n<3?e.jsxs(b,{type:"button",onClick:w,children:["Next Step ",e.jsx(V,{size:20,className:"ml-2"})]}):e.jsxs(b,{type:"submit",isLoading:x,children:[e.jsx(q,{size:20,className:"mr-2"})," Update Profile"]})]})]})]})]})})},v=({step:r,currentStep:o,label:n,icon:c})=>{const m=o===r,u=o>r;return e.jsxs("div",{className:`flex-1 flex flex-col items-center py-4 transition-colors relative ${m?"text-primary-600 dark:text-primary-400":u?"text-green-600 dark:text-green-500":"text-slate-400"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(c,{size:18}),e.jsxs("span",{className:"text-sm font-bold uppercase tracking-wider",children:["Step ",r]})]}),e.jsx("span",{className:"text-xs font-medium",children:n}),m&&e.jsx(f.div,{layoutId:"stepUnderline",className:"absolute bottom-0 h-1 bg-primary-600 dark:bg-primary-400 w-full"})]})},p=({label:r,name:o,value:n,onChange:c,options:m,required:u})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 ml-1",children:r}),e.jsx("select",{name:o,value:n,onChange:c,required:u,className:"w-full h-11 rounded-xl border border-slate-200 bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white px-4 focus:ring-2 focus:ring-primary-100 focus:border-primary-500 transition-all outline-none",children:m.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))})]});export{X as default};
