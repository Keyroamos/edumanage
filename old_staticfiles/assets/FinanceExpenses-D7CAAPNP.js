import{r as d,e as u,j as e,m as o,A as T}from"./vendor-Cr6tcs86.js";import{B as c}from"./index-D6YSVT4s.js";import{$ as F,D as L,t as q,C as I,F as v,aV as K,k as P,w as B,af as O,K as V,X as R,x as $}from"./ui-kKL2mqtN.js";const H=()=>{const[h,N]=d.useState([]),[Q,g]=d.useState(!1),[w,n]=d.useState(!1),[x,C]=d.useState(""),[m,S]=d.useState("all"),[b,f]=d.useState({total:0,thisMonth:0,lastMonth:0,byCategory:{}}),[a,r]=d.useState({title:"",amount:"",category:"utilities",description:"",date:new Date().toISOString().split("T")[0],vendor:"",payment_method:"cash",receipt_number:""}),i=[{value:"utilities",label:"Utilities",color:"bg-blue-500",icon:"âš¡"},{value:"salaries",label:"Salaries",color:"bg-green-500",icon:"ðŸ’°"},{value:"supplies",label:"Supplies",color:"bg-purple-500",icon:"ðŸ“¦"},{value:"maintenance",label:"Maintenance",color:"bg-orange-500",icon:"ðŸ”§"},{value:"transport",label:"Transport",color:"bg-yellow-500",icon:"ðŸšŒ"},{value:"food",label:"Food",color:"bg-red-500",icon:"ðŸ½ï¸"},{value:"other",label:"Other",color:"bg-gray-500",icon:"ðŸ“‹"}],j=[{value:"cash",label:"Cash",icon:"ðŸ’µ"},{value:"bank_transfer",label:"Bank Transfer",icon:"ðŸ¦"},{value:"cheque",label:"Cheque",icon:"ðŸ“"},{value:"mobile_money",label:"Mobile Money",icon:"ðŸ“±"}];d.useEffect(()=>{p()},[]);const p=async()=>{g(!0);try{const t=await u.get("/api/finance/expenses/");t.data.success&&(N(t.data.expenses),f({total:t.data.stats.total_expenses,thisMonth:t.data.stats.month_expenses,lastMonth:0,byCategory:{}}),E(t.data.expenses))}catch(t){console.error("Error fetching expenses:",t)}finally{g(!1)}},E=t=>{const s={};t.forEach(l=>{s[l.category]=(s[l.category]||0)+l.amount}),f(l=>({...l,byCategory:s}))},z=async t=>{t.preventDefault();try{(await u.post("/api/finance/expenses/",{...a,amount:parseFloat(a.amount)})).data.success&&(p(),n(!1),M())}catch(s){console.error("Error adding expense:",s),alert("Failed to add expense")}},D=async t=>{if(window.confirm("Are you sure you want to delete this expense?"))try{(await u.delete(`/api/finance/expenses/${t}/`)).data.success&&p()}catch(s){console.error("Error deleting expense:",s),alert("Failed to delete expense")}},M=()=>{r({title:"",amount:"",category:"utilities",description:"",date:new Date().toISOString().split("T")[0],vendor:"",payment_method:"cash",receipt_number:""})},_=t=>i.find(s=>s.value===t)||i[i.length-1],y=h.filter(t=>{const s=t.title.toLowerCase().includes(x.toLowerCase())||t.vendor.toLowerCase().includes(x.toLowerCase()),l=m==="all"||t.category===m;return s&&l});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Expense Management"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Track and manage all school expenses"})]}),e.jsxs(c,{onClick:()=>n(!0),className:"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800",children:[e.jsx(F,{size:20,className:"mr-2"}),"Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(L,{size:24})}),e.jsx(q,{size:20,className:"text-white/80"})]}),e.jsx("p",{className:"text-emerald-100 text-sm font-medium mb-1",children:"Total Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KES ",b.total.toLocaleString()]})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:e.jsx(I,{size:24,className:"text-blue-600 dark:text-blue-400"})})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium mb-1",children:"This Month"}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:["KES ",b.thisMonth.toLocaleString()]})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-xl",children:e.jsx(v,{size:24,className:"text-purple-600 dark:text-purple-400"})})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium mb-1",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:h.length})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/20 rounded-xl",children:e.jsx(K,{size:24,className:"text-orange-600 dark:text-orange-400"})})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium mb-1",children:"Categories"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:Object.keys(b.byCategory).length})]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search expenses by title or vendor...",value:x,onChange:t=>C(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:m,onChange:t=>S(t.target.value),className:"px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Categories"}),i.map(t=>e.jsxs("option",{value:t.value,children:[t.icon," ",t.label]},t.value))]}),e.jsxs(c,{variant:"outline",className:"border-slate-200 dark:border-slate-700",children:[e.jsx(B,{size:20,className:"mr-2"}),"Export"]})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Expense"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Vendor"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Payment"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-800",children:y.map((t,s)=>{const l=_(t.category),k=j.find(A=>A.value===t.payment_method);return e.jsxs(o.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.05},className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-400",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t.receipt_number})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium text-white ${l.color}`,children:[e.jsx("span",{className:"mr-1",children:l.icon}),l.label]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 dark:text-slate-400",children:t.vendor}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"inline-flex items-center text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("span",{className:"mr-1",children:k?.icon}),k?.label]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:["KES ",t.amount.toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:e.jsx(O,{size:16})}),e.jsx("button",{onClick:()=>D(t.id),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(V,{size:16})})]})})]},t.id)})})]})}),y.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{size:48,className:"mx-auto text-slate-300 dark:text-slate-700 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No expenses found"})]})]}),e.jsx(T,{children:w&&e.jsxs(e.Fragment,{children:[e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:()=>n(!1)}),e.jsx(o.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Add New Expense"}),e.jsx("button",{onClick:()=>n(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:e.jsx(R,{size:20,className:"text-slate-500"})})]}),e.jsxs("form",{onSubmit:z,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Expense Title *"}),e.jsx("input",{type:"text",value:a.title,onChange:t=>r({...a,title:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",placeholder:"e.g., Electricity Bill",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Amount (KES) *"}),e.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:t=>r({...a,amount:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",placeholder:"0.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Date *"}),e.jsx("input",{type:"date",value:a.date,onChange:t=>r({...a,date:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Category *"}),e.jsx("select",{value:a.category,onChange:t=>r({...a,category:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",required:!0,children:i.map(t=>e.jsxs("option",{value:t.value,children:[t.icon," ",t.label]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Payment Method *"}),e.jsx("select",{value:a.payment_method,onChange:t=>r({...a,payment_method:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",required:!0,children:j.map(t=>e.jsxs("option",{value:t.value,children:[t.icon," ",t.label]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Vendor/Supplier"}),e.jsx("input",{type:"text",value:a.vendor,onChange:t=>r({...a,vendor:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",placeholder:"e.g., Kenya Power"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Receipt Number"}),e.jsx("input",{type:"text",value:a.receipt_number,onChange:t=>r({...a,receipt_number:t.target.value}),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white",placeholder:"e.g., INV-2026-001"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:t=>r({...a,description:t.target.value}),rows:3,className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-600 focus:border-transparent transition-all text-slate-900 dark:text-white resize-none",placeholder:"Additional details about this expense..."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>n(!1),className:"flex-1",children:"Cancel"}),e.jsxs(c,{type:"submit",className:"flex-1 bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800",children:[e.jsx($,{size:20,className:"mr-2"}),"Add Expense"]})]})]})]})})]})})]})};export{H as default};
