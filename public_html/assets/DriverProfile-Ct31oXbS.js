import{r as a,e as n,j as e}from"./vendor-Cr6tcs86.js";import{C as A,W as C,$ as p,X as f}from"./ui-BBn2VFCU.js";const D=()=>{const[d,_]=a.useState(JSON.parse(localStorage.getItem("user"))),[m,j]=a.useState([]),[b,w]=a.useState([]),[i,u]=a.useState("leave"),[k,o]=a.useState(!1),[N,c]=a.useState(!1),[s,l]=a.useState({start_date:"",end_date:"",reason:""}),[r,x]=a.useState({amount:"",reason:""});a.useEffect(()=>{h(),g()},[]);const h=async()=>{try{const t=await n.get("/api/driver/leaves/");j(t.data.leaves||[])}catch{}},g=async()=>{try{const t=await n.get("/api/driver/advances/");w(t.data.advances||[])}catch{}},y=async t=>{t.preventDefault();try{await n.post("/api/driver/leaves/",s),o(!1),l({start_date:"",end_date:"",reason:""}),h(),alert("Leave request submitted")}catch{alert("Failed to submit")}},S=async t=>{t.preventDefault();try{await n.post("/api/driver/advances/",r),c(!1),x({amount:"",reason:""}),g(),alert("Advance request submitted")}catch{alert("Failed to submit")}},v=({status:t})=>e.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-bold uppercase tracking-wide border ${t==="APPROVED"?"bg-emerald-50 border-emerald-200 text-emerald-700 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-400":t==="REJECTED"?"bg-rose-50 border-rose-200 text-rose-700 dark:bg-rose-900/20 dark:border-rose-800 dark:text-rose-400":"bg-amber-50 border-amber-200 text-amber-700 dark:bg-amber-900/20 dark:border-amber-800 dark:text-amber-400"}`,children:t});return e.jsxs("div",{className:"space-y-6 pb-20 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 rounded-3xl p-6 shadow-xl text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full blur-3xl -mr-10 -mt-10"}),e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsxs("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center text-2xl font-bold backdrop-blur-sm border border-white/30",children:[d.first_name[0],d.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:[d.first_name," ",d.last_name]}),e.jsx("p",{className:"text-indigo-100",children:"Driver Account"})]})]})]}),e.jsxs("div",{className:"flex p-1 bg-white dark:bg-slate-800 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm",children:[e.jsxs("button",{onClick:()=>u("leave"),className:`flex-1 py-3 text-sm font-bold rounded-xl transition-all flex items-center justify-center gap-2 ${i==="leave"?"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(A,{size:18})," Leaves"]}),e.jsx("div",{className:"w-px bg-slate-100 dark:bg-slate-700 my-2"}),e.jsxs("button",{onClick:()=>u("advance"),className:`flex-1 py-3 text-sm font-bold rounded-xl transition-all flex items-center justify-center gap-2 ${i==="advance"?"bg-emerald-50 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(C,{size:18})," Advances"]})]}),i==="leave"?e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white",children:"Leave History"}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-indigo-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx(p,{size:14})," Request Leave"]})]}),(m||[]).length===0?e.jsx("p",{className:"text-slate-500 text-sm text-center py-6",children:"No leave requests."}):(m||[]).map(t=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400 px-2 py-1 rounded text-xs font-bold",children:[t.start_date," â†’ ",t.end_date]}),e.jsx(v,{status:t.status})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:t.reason})]},t.id))]}):e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white",children:"Salary Advances"}),e.jsxs("button",{onClick:()=>c(!0),className:"bg-emerald-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx(p,{size:14})," Request Advance"]})]}),(b||[]).length===0?e.jsx("p",{className:"text-slate-500 text-sm text-center py-6",children:"No advance requests."}):(b||[]).map(t=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-slate-900 dark:text-white text-lg",children:["KES ",parseFloat(t.amount).toLocaleString()]}),e.jsx("p",{className:"text-xs text-slate-500",children:t.reason})]}),e.jsx(v,{status:t.status})]},t.id))]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full max-w-sm rounded-3xl p-6 shadow-2xl animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h3",{className:"font-bold dark:text-white",children:"Request Leave"}),e.jsx(f,{className:"cursor-pointer",onClick:()=>o(!1)})]}),e.jsxs("form",{onSubmit:y,className:"space-y-3",children:[e.jsx("input",{type:"date",required:!0,className:"w-full p-3 rounded-xl border bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:s.start_date,onChange:t=>l({...s,start_date:t.target.value}),placeholder:"Start"}),e.jsx("input",{type:"date",required:!0,className:"w-full p-3 rounded-xl border bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:s.end_date,onChange:t=>l({...s,end_date:t.target.value}),placeholder:"End"}),e.jsx("textarea",{required:!0,rows:"2",className:"w-full p-3 rounded-xl border bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white",placeholder:"Reason",value:s.reason,onChange:t=>l({...s,reason:t.target.value})}),e.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700",children:"Submit Request"})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full max-w-sm rounded-3xl p-6 shadow-2xl animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h3",{className:"font-bold dark:text-white",children:"Request Advance"}),e.jsx(f,{className:"cursor-pointer",onClick:()=>c(!1)})]}),e.jsxs("form",{onSubmit:S,className:"space-y-3",children:[e.jsx("input",{type:"number",required:!0,className:"w-full p-3 rounded-xl border bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white text-lg font-bold font-mono",placeholder:"Amount (KES)",value:r.amount,onChange:t=>x({...r,amount:t.target.value})}),e.jsx("textarea",{required:!0,rows:"2",className:"w-full p-3 rounded-xl border bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-white",placeholder:"Reason",value:r.reason,onChange:t=>x({...r,reason:t.target.value})}),e.jsx("button",{type:"submit",className:"w-full bg-emerald-600 text-white font-bold py-3 rounded-xl hover:bg-emerald-700",children:"Submit Request"})]})]})})]})};export{D as default};
