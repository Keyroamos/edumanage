import{u as z,r,e as u,j as e,m as v,A as _}from"./vendor-Cr6tcs86.js";import{I as R,B as f}from"./index-BxkJ-YYo.js";import{Q as k,U as w,C as S,D as C,j as E,N as L,X as A,h as M,aa as q}from"./ui-BBn2VFCU.js";const $=({leave:s,onApprove:o,onReject:m})=>{const[n,d]=r.useState(!1),[c,p]=r.useState(""),[l,g]=r.useState(null),h=i=>{g(i),d(!0)},j=()=>{l==="approve"?o(s.id,c):m(s.id,c),d(!1),p("")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-900/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-white",children:s.employee_name}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:s.leave_type_display})]}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400 rounded text-xs font-bold",children:"PENDING"})]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:["ðŸ“… ",s.start_date," to ",s.end_date," (",s.duration," days)"]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:[e.jsx("strong",{children:"Reason:"})," ",s.reason]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>h("approve"),className:"flex-1 py-2 px-3 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(q,{size:16})," Approve"]}),e.jsxs("button",{onClick:()=>h("reject"),className:"flex-1 py-2 px-3 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(A,{size:16})," Reject"]})]})]}),e.jsx(_,{children:n&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-md shadow-2xl border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:l==="approve"?"Approve Leave Request":"Reject Leave Request"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Comments (Optional)"}),e.jsx("textarea",{value:c,onChange:i=>p(i.target.value),className:"w-full rounded-lg border-slate-200 dark:border-slate-700 dark:bg-slate-800 focus:ring-primary-500 p-3",rows:"4",placeholder:"Add any comments or notes..."})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex gap-3 justify-end",children:[e.jsx(f,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(f,{onClick:j,children:l==="approve"?"Approve":"Reject"})]})]})})})]})},D=({advance:s,onApprove:o,onReject:m})=>{const[n,d]=r.useState(!1),[c,p]=r.useState(""),[l,g]=r.useState(null),h=i=>{g(i),d(!0)},j=()=>{l==="approve"?o(s.id,c):m(s.id,c),d(!1),p("")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-100 dark:border-green-900/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-white",children:s.employee_name}),e.jsxs("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:["KES ",parseFloat(s.amount).toLocaleString()]})]}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400 rounded text-xs font-bold",children:"PENDING"})]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:[e.jsx("strong",{children:"Reason:"})," ",s.reason]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>h("approve"),className:"flex-1 py-2 px-3 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(q,{size:16})," Approve"]}),e.jsxs("button",{onClick:()=>h("reject"),className:"flex-1 py-2 px-3 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(A,{size:16})," Reject"]})]})]}),e.jsx(_,{children:n&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-md shadow-2xl border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:l==="approve"?"Approve Salary Advance":"Reject Salary Advance"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Comments (Optional)"}),e.jsx("textarea",{value:c,onChange:i=>p(i.target.value),className:"w-full rounded-lg border-slate-200 dark:border-slate-700 dark:bg-slate-800 focus:ring-primary-500 p-3",rows:"4",placeholder:"Add any comments or notes..."})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex gap-3 justify-end",children:[e.jsx(f,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(f,{onClick:j,children:l==="approve"?"Approve":"Reject"})]})]})})})]})},P=({supervisor:s,onView:o})=>{const m=s.pending_leaves||0,n=s.pending_advances||0,d=s.supervised_count||0;return e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 hover:shadow-lg transition-all cursor-pointer",onClick:()=>o(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-primary-500 to-primary-700 flex items-center justify-center text-white font-bold text-xl shadow-lg",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s.position}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(k,{size:14,className:"text-primary-500"}),e.jsx("span",{className:"text-xs font-medium text-primary-600 dark:text-primary-400",children:"Supervisor"})]})]})]}),e.jsx(L,{size:20,className:"text-slate-400"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-3 text-center",children:[e.jsx(w,{size:20,className:"mx-auto text-slate-400 mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:d}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Staff"})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-3 text-center",children:[e.jsx(S,{size:20,className:"mx-auto text-yellow-500 mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:m}),e.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Leave"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-center",children:[e.jsx(C,{size:20,className:"mx-auto text-green-500 mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:n}),e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Advance"})]})]}),e.jsx("div",{className:"pt-4 border-t border-slate-100 dark:border-slate-800",children:e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 space-y-1",children:[e.jsxs("div",{children:["ðŸ“§ ",s.email]}),e.jsxs("div",{children:["ðŸ“± ",s.phone]})]})})]})},T=({supervisor:s,isOpen:o,onClose:m})=>{const[n,d]=r.useState("team"),[c,p]=r.useState([]),[l,g]=r.useState({leaves:[],advances:[]}),[h,j]=r.useState(!1);r.useEffect(()=>{o&&s&&i()},[o,s]);const i=async()=>{j(!0);try{const[t,x]=await Promise.all([u.get(`/api/hr/supervisors/${s.id}/team/`),u.get(`/api/hr/supervisors/${s.id}/pending-requests/`)]);p(t.data.team),g(x.data)}catch(t){console.error("Error fetching supervisor details:",t)}finally{j(!1)}};return!o||!s?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-4xl shadow-2xl border border-slate-200 dark:border-slate-800 max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 bg-gradient-to-r from-primary-50 to-blue-50 dark:from-primary-900/20 dark:to-blue-900/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-primary-500 to-primary-700 flex items-center justify-center text-white font-bold text-2xl shadow-lg",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:s.position})]})]}),e.jsx("button",{onClick:m,className:"p-2 hover:bg-white/50 dark:hover:bg-slate-800/50 rounded-lg transition-colors",children:e.jsx(A,{size:24,className:"text-slate-500"})})]})}),e.jsxs("div",{className:"flex gap-2 px-6 border-b border-slate-200 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>d("team"),className:`px-4 py-3 font-medium transition-colors relative ${n==="team"?"text-primary-600 dark:text-primary-400":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[e.jsx(w,{size:18,className:"inline mr-2"}),"Team Members (",c.length,")",n==="team"&&e.jsx(v.div,{layoutId:"activeDetailTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-600 dark:bg-primary-400"})]}),e.jsxs("button",{onClick:()=>d("requests"),className:`px-4 py-3 font-medium transition-colors relative ${n==="requests"?"text-primary-600 dark:text-primary-400":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[e.jsx(M,{size:18,className:"inline mr-2"}),"Pending Requests (",(l.leaves?.length||0)+(l.advances?.length||0),")",n==="requests"&&e.jsx(v.div,{layoutId:"activeDetailTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-600 dark:bg-primary-400"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:h?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs(e.Fragment,{children:[n==="team"&&e.jsx("div",{className:"space-y-3",children:c.length>0?c.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"h-10 w-10 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center text-primary-700 dark:text-primary-400 font-bold",children:[t.first_name[0],t.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-900 dark:text-white",children:[t.first_name," ",t.last_name]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t.staff_type_display||t.position})]})]}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-bold ${t.status==="ACTIVE"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":t.status==="ON_LEAVE"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:t.status})]},t.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{size:48,className:"mx-auto text-slate-300 dark:text-slate-700 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No team members assigned yet"})]})}),n==="requests"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-slate-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(S,{size:18,className:"text-blue-500"}),"Leave Requests"]}),l.leaves?.length>0?e.jsx("div",{className:"space-y-3",children:l.leaves.map(t=>e.jsx($,{leave:t,onApprove:async(x,b)=>{try{await u.post(`/api/hr/supervisors/leave-requests/${x}/approve/`,{comments:b}),i()}catch{alert("Error approving request")}},onReject:async(x,b)=>{try{await u.post(`/api/hr/supervisors/leave-requests/${x}/reject/`,{comments:b}),i()}catch{alert("Error rejecting request")}}},t.id))}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No pending leave requests"})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("h3",{className:"font-semibold text-slate-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(C,{size:18,className:"text-green-500"}),"Salary Advance Requests"]}),l.advances?.length>0?e.jsx("div",{className:"space-y-3",children:l.advances.map(t=>e.jsx(D,{advance:t,onApprove:async(x,b)=>{try{await u.post(`/api/hr/supervisors/advance-requests/${x}/approve/`,{comments:b}),i()}catch{alert("Error approving request")}},onReject:async(x,b)=>{try{await u.post(`/api/hr/supervisors/advance-requests/${x}/reject/`,{comments:b}),i()}catch{alert("Error rejecting request")}}},t.id))}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No pending advance requests"})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(f,{variant:"secondary",onClick:m,children:"Close"}),e.jsx(f,{onClick:()=>window.location.href="/hr/approvals",children:"View All Approvals"})]})})]})})},B=()=>{z();const[s,o]=r.useState([]),[m,n]=r.useState(!0),[d,c]=r.useState(""),[p,l]=r.useState(null),[g,h]=r.useState(!1);r.useEffect(()=>{j()},[]);const j=async()=>{try{const a=await u.get("/api/hr/supervisors/");o(a.data.supervisors)}catch(a){console.error("Error fetching supervisors:",a)}finally{n(!1)}},i=a=>{l(a),h(!0)},t=s.filter(a=>`${a.first_name} ${a.last_name} ${a.email}`.toLowerCase().includes(d.toLowerCase())),x=s.reduce((a,y)=>a+(y.pending_leaves||0),0),b=s.reduce((a,y)=>a+(y.pending_advances||0),0),N=s.reduce((a,y)=>a+(y.supervised_count||0),0);return m?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"p-6 md:p-8 bg-slate-50 dark:bg-slate-950 min-h-screen",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-primary-100 dark:bg-primary-900/30 rounded-xl",children:e.jsx(k,{size:28,className:"text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Supervisors"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Manage supervisor assignments and team oversight"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Total Supervisors"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:s.length})]}),e.jsx(k,{size:24,className:"text-primary-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Staff Supervised"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:N})]}),e.jsx(w,{size:24,className:"text-blue-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Pending Leaves"}),e.jsx("h3",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:x})]}),e.jsx(S,{size:24,className:"text-yellow-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Pending Advances"}),e.jsx("h3",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:b})]}),e.jsx(C,{size:24,className:"text-green-500"})]})})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6",children:e.jsx(R,{placeholder:"Search supervisors by name or email...",value:d,onChange:a=>c(a.target.value),icon:E})})]}),t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(a=>e.jsx(P,{supervisor:a,onView:i},a.id))}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-12 text-center",children:[e.jsx(k,{size:48,className:"mx-auto text-slate-300 dark:text-slate-700 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-2",children:"No supervisors found"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Assign supervisors to staff members in the Staff Management section"})]})]}),e.jsx(T,{supervisor:p,isOpen:g,onClose:()=>h(!1)})]})};export{B as default};
